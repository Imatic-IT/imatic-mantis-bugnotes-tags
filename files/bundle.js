(()=>{"use strict";var e=function(e,t,o,i){return new(o||(o=Promise))((function(s,n){function r(e){try{c(i.next(e))}catch(e){n(e)}}function a(e){try{c(i.throw(e))}catch(e){n(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,a)}c((i=i.apply(e,t||[])).next())}))};const t={url:"",actions:{highlight:"",unhighlight:"",get_highlights:"",reaction:"",get_reactions:""},bugId:""};function o(){return e(this,void 0,void 0,(function*(){const e=document.querySelector("#imaticNoteHighlighting").dataset.data;if(!e)throw new Error("Missing data attribute on #imaticNoteHighlighting element");return JSON.parse(e)}))}function i(e){if("string"!=typeof e||!e)throw new Error("expected a non-empty string, got: "+e)}function s(e){if("number"!=typeof e)throw new Error("expected a number, got: "+e)}const n="emoji",r="keyvalue",a="favorites",c="tokens",l="count",d="group-order",h="eTag",u="url",m="skinTone",p="readonly",g="readwrite",f="skinUnicodes";function v(e){return function(e,t){const o=new Set,i=[];for(const s of e){const e=t(s);o.has(e)||(o.add(e),i.push(s))}return i}(e,(e=>e.unicode))}const y={},w={},b={};function k(e,t,o){o.onerror=()=>t(o.error),o.onblocked=()=>t(new Error("IDB blocked")),o.onsuccess=()=>e(o.result)}async function j(e){const t=await new Promise(((t,o)=>{const i=indexedDB.open(e,1);y[e]=i,i.onupgradeneeded=e=>{e.oldVersion<1&&function(e){function t(t,o,i){const s=o?e.createObjectStore(t,{keyPath:o}):e.createObjectStore(t);if(i)for(const[e,[t,o]]of Object.entries(i))s.createIndex(e,t,{multiEntry:o});return s}t(r),t(n,"unicode",{[c]:["tokens",!0],[d]:[["group","order"]],[f]:["skinUnicodes",!0]}),t(a,void 0,{[l]:[""]})}(i.result)},k(t,o,i)}));return t.onclose=()=>_(e),t}function C(e,t,o,i){return new Promise(((s,n)=>{const r=e.transaction(t,o,{durability:"relaxed"}),a="string"==typeof t?r.objectStore(t):t.map((e=>r.objectStore(e)));let c;i(a,r,(e=>{c=e})),r.oncomplete=()=>s(c),r.onerror=()=>n(r.error)}))}function _(e){const t=y[e],o=t&&t.result;if(o){o.close();const t=b[e];if(t)for(const e of t)e()}delete y[e],delete w[e],delete b[e]}const x=new Set([":D","XD",":'D","O:)",":X",":P",";P","XP",":L",":Z",":j","8D","XO","8)",":B",":O",":S",":'o","Dx","X(","D:",":C",">0)",":3","</3","<3","\\M/",":E","8#"]);function E(e){return e.split(/[\s_]+/).map((e=>!e.match(/\w/)||x.has(e)?e.toLowerCase():e.replace(/[)(:,]/g,"").replace(/’/g,"'").toLowerCase())).filter(Boolean)}function S(e){return e.filter(Boolean).map((e=>e.toLowerCase())).filter((e=>e.length>=2))}function L(e,t,o,i){e[t](o).onsuccess=e=>i&&i(e.target.result)}function $(e,t,o){L(e,"get",t,o)}function z(e,t,o){L(e,"getAll",t,o)}function P(e){e.commit&&e.commit()}function T(e,t){const o=function(e,t){let o=e[0];for(let i=1;i<e.length;i++){const s=e[i];t(o)>t(s)&&(o=s)}return o}(e,(e=>e.length)),i=[];for(const s of o)e.some((e=>-1===e.findIndex((e=>t(e)===t(s)))))||i.push(s);return i}async function I(e,t,o,i){try{const s=function(e){return e.map((({annotation:e,emoticon:t,group:o,order:i,shortcodes:s,skins:n,tags:r,emoji:a,version:c})=>{const l={annotation:e,group:o,order:i,tags:r,tokens:[...new Set(S([...(s||[]).map(E).flat(),...(r||[]).map(E).flat(),...E(e),t]))].sort(),unicode:a,version:c};if(t&&(l.emoticon=t),s&&(l.shortcodes=s),n){l.skinTones=[],l.skinUnicodes=[],l.skinVersions=[];for(const{tone:e,emoji:t,version:o}of n)l.skinTones.push(e),l.skinUnicodes.push(t),l.skinVersions.push(o)}return l}))}(t);await C(e,[n,r],g,(([e,t],n)=>{let r,a,c=0;function l(){2==++c&&function(){if(r===i&&a===o)return;e.clear();for(const t of s)e.put(t);t.put(i,h),t.put(o,u),P(n)}()}$(t,h,(e=>{r=e,l()})),$(t,u,(e=>{a=e,l()}))}))}finally{}}async function F(e,t){const o=S(E(t));return o.length?C(e,n,p,((e,t,i)=>{const s=[],n=()=>{const e=T(s,(e=>e.unicode));i(e.sort(((e,t)=>e.order<t.order?-1:1)))};for(let t=0;t<o.length;t++){const i=o[t],r=t===o.length-1?IDBKeyRange.bound(i,i+"￿",!1,!0):IDBKeyRange.only(i);z(e.index(c),r,(e=>{s.push(e),s.length===o.length&&n()}))}})):[]}async function B(e,t){const o=await F(e,t);if(!o.length){const o=e=>(e.shortcodes||[]).includes(t.toLowerCase());return await async function(e,t){return C(e,n,p,((e,o,i)=>{let s;const n=()=>{e.getAll(s&&IDBKeyRange.lowerBound(s,!0),50).onsuccess=e=>{const o=e.target.result;for(const e of o)if(s=e.unicode,t(e))return i(e);if(o.length<50)return i();n()}};n()}))}(e,o)||null}return o.filter((e=>{const o=(e.shortcodes||[]).map((e=>e.toLowerCase()));return o.includes(t.toLowerCase())}))[0]||null}function A(e,t,o){return C(e,t,p,((e,t,i)=>$(e,o,i)))}const M=["name","url"];function R(e){!function(e){const t=e&&Array.isArray(e),o=t&&e.length&&(!e[0]||M.some((t=>!(t in e[0]))));if(!t||o)throw new Error("Custom emojis are in the wrong format")}(e);const t=(e,t)=>e.name.toLowerCase()<t.name.toLowerCase()?-1:1,o=e.sort(t),i=function(e,t){const o=new Map;for(const i of e){const e=t(i);for(const t of e){let e=o;for(let o=0;o<t.length;o++){const i=t.charAt(o);let s=e.get(i);s||(s=new Map,e.set(i,s)),e=s}let s=e.get("");s||(s=[],e.set("",s)),s.push(i)}}return(e,t)=>{let i=o;for(let t=0;t<e.length;t++){const o=e.charAt(t),s=i.get(o);if(!s)return[];i=s}if(t)return i.get("")||[];const s=[],n=[i];for(;n.length;){const e=[...n.shift().entries()].sort(((e,t)=>e[0]<t[0]?-1:1));for(const[t,o]of e)""===t?s.push(...o):n.push(o)}return s}}(e,(e=>{const t=new Set;if(e.shortcodes)for(const o of e.shortcodes)for(const e of E(o))t.add(e);return t})),s=e=>i(e,!0),n=e=>i(e,!1),r=new Map,a=new Map;for(const t of e){a.set(t.name.toLowerCase(),t);for(const e of t.shortcodes||[])r.set(e.toLowerCase(),t)}return{all:o,search:e=>{const o=E(e);return T(o.map(((e,t)=>(t<o.length-1?s:n)(e))),(e=>e.name)).sort(t)},byShortcode:e=>r.get(e.toLowerCase()),byName:e=>a.get(e.toLowerCase())}}const N="undefined"!=typeof wrappedJSObject;function O(e){if(!e)return e;if(N&&(e=structuredClone(e)),delete e.tokens,e.skinTones){const t=e.skinTones.length;e.skins=Array(t);for(let o=0;o<t;o++)e.skins[o]={tone:e.skinTones[o],unicode:e.skinUnicodes[o],version:e.skinVersions[o]};delete e.skinTones,delete e.skinUnicodes,delete e.skinVersions}return e}function V(e){e||console.warn("emoji-picker-element is more efficient if the dataSource server exposes an ETag header.")}const D=["annotation","emoji","group","order","version"];function H(e,t){if(2!==Math.floor(e.status/100))throw new Error("Failed to fetch: "+t+":  "+e.status)}async function U(e){const t=await fetch(e);H(t,e);const o=t.headers.get("etag");V(o);const i=await t.json();return function(e){if(!e||!Array.isArray(e)||!e[0]||"object"!=typeof e[0]||D.some((t=>!(t in e[0]))))throw new Error("Emoji data is in the wrong format")}(i),[o,i]}async function W(e){let t=function(e){for(var t=e.length,o=new ArrayBuffer(t),i=new Uint8Array(o),s=-1;++s<t;)i[s]=e.charCodeAt(s);return o}(JSON.stringify(e));const o=function(e){for(var t="",o=new Uint8Array(e),i=o.byteLength,s=-1;++s<i;)t+=String.fromCharCode(o[s]);return t}(await crypto.subtle.digest("SHA-1",t));return btoa(o)}async function q(e,t){let o,i=await async function(e){const t=await fetch(e,{method:"HEAD"});H(t,e);const o=t.headers.get("etag");return V(o),o}(t);if(!i){const e=await U(t);i=e[0],o=e[1],i||(i=await W(o))}if(await async function(e,t,o){const[i,s]=await Promise.all([h,u].map((t=>A(e,r,t))));return i===o&&s===t}(e,t,i));else{if(!o){o=(await U(t))[1]}await I(e,o,t,i)}}class K{constructor({dataSource:e="https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json",locale:t="en",customEmoji:o=[]}={}){this.dataSource=e,this.locale=t,this._dbName=`emoji-picker-element-${this.locale}`,this._db=void 0,this._lazyUpdate=void 0,this._custom=R(o),this._clear=this._clear.bind(this),this._ready=this._init()}async _init(){const e=this._db=await(t=this._dbName,w[t]||(w[t]=j(t)),w[t]);var t;!function(e,t){let o=b[e];o||(o=b[e]=[]),o.push(t)}(this._dbName,this._clear);const o=this.dataSource,i=await async function(e){return!await A(e,r,u)}(e);i?await async function(e,t){let[o,i]=await U(t);o||(o=await W(i)),await I(e,i,t,o)}(e,o):this._lazyUpdate=q(e,o)}async ready(){const e=async()=>(this._ready||(this._ready=this._init()),this._ready);await e(),this._db||await e()}async getEmojiByGroup(e){return s(e),await this.ready(),v(await async function(e,t){return C(e,n,p,((e,o,i)=>{const s=IDBKeyRange.bound([t,0],[t+1,0],!1,!0);z(e.index(d),s,i)}))}(this._db,e)).map(O)}async getEmojiBySearchQuery(e){i(e),await this.ready();return[...this._custom.search(e),...v(await F(this._db,e)).map(O)]}async getEmojiByShortcode(e){i(e),await this.ready();const t=this._custom.byShortcode(e);return t||O(await B(this._db,e))}async getEmojiByUnicodeOrName(e){i(e),await this.ready();const t=this._custom.byName(e);return t||O(await async function(e,t){return C(e,n,p,((e,o,i)=>$(e,t,(o=>{if(o)return i(o);$(e.index(f),t,(e=>i(e||null)))}))))}(this._db,e))}async getPreferredSkinTone(){return await this.ready(),await A(this._db,r,m)||0}async setPreferredSkinTone(e){return s(e),await this.ready(),t=this._db,o=m,i=e,C(t,r,g,((e,t)=>{e.put(i,o),P(t)}));var t,o,i}async incrementFavoriteEmojiCount(e){return i(e),await this.ready(),t=this._db,o=e,C(t,a,g,((e,t)=>$(e,o,(i=>{e.put((i||0)+1,o),P(t)}))));var t,o}async getTopFavoriteEmoji(e){return s(e),await this.ready(),(await function(e,t,o){return 0===o?[]:C(e,[a,n],p,(([e,i],s,n)=>{const r=[];e.index(l).openCursor(void 0,"prev").onsuccess=e=>{const s=e.target.result;if(!s)return n(r);function a(e){if(r.push(e),r.length===o)return n(r);s.continue()}const c=s.primaryKey,l=t.byName(c);if(l)return a(l);$(i,c,(e=>{if(e)return a(e);s.continue()}))}}))}(this._db,this._custom,e)).map(O)}set customEmoji(e){this._custom=R(e)}get customEmoji(){return this._custom.all}async _shutdown(){await this.ready();try{await this._lazyUpdate}catch(e){}}_clear(){this._db=this._ready=this._lazyUpdate=void 0}async close(){await this._shutdown(),await _(this._dbName)}async delete(){var e;await this._shutdown(),await(e=this._dbName,new Promise(((t,o)=>{_(e),k(t,o,indexedDB.deleteDatabase(e))})))}}const G=[[-1,"✨","custom"],[0,"😀","smileys-emotion"],[1,"👋","people-body"],[3,"🐱","animals-nature"],[4,"🍎","food-drink"],[5,"🏠️","travel-places"],[6,"⚽","activities"],[7,"📝","objects"],[8,"⛔️","symbols"],[9,"🏁","flags"]].map((([e,t,o])=>({id:e,emoji:t,name:o}))),J=G.slice(1),X="function"==typeof requestIdleCallback?requestIdleCallback:setTimeout;function Y(e){return e.unicode.includes("‍")}const Q={"🫨":15.1,"🫠":14,"🥲":13.1,"🥻":12.1,"🥰":11,"🤩":5,"👱‍♀️":4,"🤣":3,"👁️‍🗨️":2,"😀":1,"😐️":.7,"😃":.6},Z=["😊","😒","❤️","👍️","😍","😂","😭","☺️","😔","😩","😏","💕","🙌","😘"],ee='"Twemoji Mozilla","Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji","EmojiOne Color","Android Emoji",sans-serif',te=(e,t)=>e<t?-1:e>t?1:0,oe=(e,t)=>{const o=document.createElement("canvas");o.width=o.height=1;const i=o.getContext("2d",{willReadFrequently:!0});return i.textBaseline="top",i.font=`100px ${ee}`,i.fillStyle=t,i.scale(.01,.01),i.fillText(e,0,0),i.getImageData(0,0,1,1).data};function ie(e){const t=oe(e,"#000"),o=oe(e,"#fff");return t&&o&&((e,t)=>{const o=[...e].join(",");return o===[...t].join(",")&&!o.startsWith("0,0,0,")})(t,o)}let se;const ne=()=>(se||(se=new Promise((e=>X((()=>e(function(){const e=Object.entries(Q);try{for(const[t,o]of e)if(ie(t))return o}catch(e){}return e[0][1]}())))))),se),re=new Map;function ae(e){e.preventDefault(),e.stopPropagation()}function ce(e,t,o){return(t+=e?-1:1)<0?t=o.length-1:t>=o.length&&(t=0),t}function le(e,t){const o=new Set,i=[];for(const s of e){const e=t(s);o.has(e)||(o.add(e),i.push(s))}return i}const de=requestAnimationFrame;let he,ue="function"==typeof ResizeObserver;function me(e){{const t=document.createRange();return t.selectNode(e.firstChild),t.getBoundingClientRect().width}}function pe(e,t,o){let i=e.get(t);return i||(i=o(),e.set(t,i)),i}function ge(e){return""+e}const fe=new WeakMap,ve=new WeakMap,ye=Symbol("un-keyed"),we="replaceChildren"in Element.prototype;function be(e,t){const{targetNode:o}=t;let{targetParentNode:i}=t,s=!1;i?s=function(e,t){let o=e.firstChild,i=0;for(;o;){if(t[i]!==o)return!0;o=o.nextSibling,i++}return i!==t.length}(i,e):(s=!0,t.targetNode=void 0,t.targetParentNode=i=o.parentNode),s&&function(e,t){we?e.replaceChildren(...t):(e.innerHTML="",e.append(...t))}(i,e)}function ke(e){let t="",o=!1,i=!1,s=-1;const n=new Map,r=[];for(let a=0,c=e.length;a<c;a++){const l=e[a];if(t+=l,a===c-1)break;for(let e=0;e<l.length;e++){switch(l.charAt(e)){case"<":"/"===l.charAt(e+1)?r.pop():(o=!0,r.push(++s));break;case">":o=!1,i=!1;break;case"=":i=!0}}const d=pe(n,r[r.length-1],(()=>[]));let h,u,m;if(i){const t=/(\S+)="?([^"=]*)$/.exec(l);h=t[1],u=t[2],m=/^[^">]*/.exec(e[a+1])[0]}const p={attributeName:h,attributeValuePre:u,attributeValuePost:m,expressionIndex:a};d.push(p),o||i||(t+=" ")}const a=function(e){const t=document.createElement("template");return t.innerHTML=e,t}(t);return{template:a,elementsToBindings:n}}function je(e,t,o){for(let i=0;i<e.length;i++){const s=e[i],n={binding:s,targetNode:s.attributeName?t:t.firstChild,targetParentNode:void 0,currentExpression:void 0};o.push(n)}}function Ce(e){const{template:t,elementsToBindings:o}=pe(fe,e,(()=>ke(e))),i=t.cloneNode(!0).content.firstElementChild,s=function(e,t){const o=[];let i;if(1===t.size&&(i=t.get(0)))je(i,e,o);else{const i=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT);let s=e,n=-1;do{const e=t.get(++n);e&&je(e,s,o)}while(s=i.nextNode())}return o}(i,o);return function(e){return function(e,t){for(const o of t){const{targetNode:t,currentExpression:i,binding:{expressionIndex:s,attributeName:n,attributeValuePre:r,attributeValuePost:a}}=o,c=e[s];if(i!==c)if(o.currentExpression=c,n)t.setAttribute(n,r+ge(c)+a);else{let e;Array.isArray(c)?be(c,o):c instanceof Element?(e=c,t.replaceWith(e)):t.nodeValue=ge(c),e&&(o.targetNode=e)}}}(e,s),i}}function _e(e,t,o,i,s,n,r,a,c){const{labelWithSkin:l,titleForEmoji:d,unicodeWithSkin:h}=o,{html:u,map:m}=function(e){const t=pe(ve,e,(()=>new Map));let o=ye;return{map:function(e,t,i){return e.map(((e,s)=>{const n=o;o=i(e);try{return t(e,s)}finally{o=n}}))},html:function(e,...i){const s=pe(t,e,(()=>new Map));return pe(s,o,(()=>Ce(e)))(i)}}}(t);function p(e,o,i){return m(e,((e,s)=>u`<button role="${o?"option":"menuitem"}" aria-selected="${o?s===t.activeSearchItem:""}" aria-label="${l(e,t.currentSkinTone)}" title="${d(e)}" class="${"emoji"+(o&&s===t.activeSearchItem?" active":"")+(e.unicode?"":" custom-emoji")}" id="${`${i}-${e.id}`}" style="${e.unicode?"":`--custom-emoji-background: url(${JSON.stringify(e.url)})`}">${e.unicode?h(e,t.currentSkinTone):""}</button>`),(e=>`${i}-${e.id}`))}const g=u`<section data-ref="rootElement" class="picker" aria-label="${t.i18n.regionLabel}" style="${t.pickerStyle||""}"><div class="pad-top"></div><div class="search-row"><div class="search-wrapper"><input id="search" class="search" type="search" role="combobox" enterkeyhint="search" placeholder="${t.i18n.searchLabel}" autocapitalize="none" autocomplete="off" spellcheck="true" aria-expanded="${!(!t.searchMode||!t.currentEmojis.length)}" aria-controls="search-results" aria-describedby="search-description" aria-autocomplete="list" aria-activedescendant="${t.activeSearchItemId?`emo-${t.activeSearchItemId}`:""}" data-ref="searchElement" data-on-input="onSearchInput" data-on-keydown="onSearchKeydown"><label class="sr-only" for="search">${t.i18n.searchLabel}</label> <span id="search-description" class="sr-only">${t.i18n.searchDescription}</span></div><div class="skintone-button-wrapper ${t.skinTonePickerExpandedAfterAnimation?"expanded":""}"><button id="skintone-button" class="emoji ${t.skinTonePickerExpanded?"hide-focus":""}" aria-label="${t.skinToneButtonLabel}" title="${t.skinToneButtonLabel}" aria-describedby="skintone-description" aria-haspopup="listbox" aria-expanded="${t.skinTonePickerExpanded}" aria-controls="skintone-list" data-on-click="onClickSkinToneButton">${t.skinToneButtonText||""}</button></div><span id="skintone-description" class="sr-only">${t.i18n.skinToneDescription}</span><div data-ref="skinToneDropdown" id="skintone-list" class="skintone-list hide-focus ${t.skinTonePickerExpanded?"":"hidden no-animate"}" style="transform:translateY(${t.skinTonePickerExpanded?0:"calc(-1 * var(--num-skintones) * var(--total-emoji-size))"})" role="listbox" aria-label="${t.i18n.skinTonesLabel}" aria-activedescendant="skintone-${t.activeSkinTone}" aria-hidden="${!t.skinTonePickerExpanded}" tabIndex="-1" data-on-focusout="onSkinToneOptionsFocusOut" data-on-click="onSkinToneOptionsClick" data-on-keydown="onSkinToneOptionsKeydown" data-on-keyup="onSkinToneOptionsKeyup">${m(t.skinTones,((e,o)=>u`<div id="skintone-${o}" class="emoji ${o===t.activeSkinTone?"active":""}" aria-selected="${o===t.activeSkinTone}" role="option" title="${t.i18n.skinTones[o]}" aria-label="${t.i18n.skinTones[o]}">${e}</div>`),(e=>e))}</div></div><div class="nav" role="tablist" style="grid-template-columns:repeat(${t.groups.length},1fr)" aria-label="${t.i18n.categoriesLabel}" data-on-keydown="onNavKeydown" data-on-click="onNavClick">${m(t.groups,(e=>u`<button role="tab" class="nav-button" aria-controls="tab-${e.id}" aria-label="${t.i18n.categories[e.name]}" aria-selected="${!t.searchMode&&t.currentGroup.id===e.id}" title="${t.i18n.categories[e.name]}" data-group-id="${e.id}"><div class="nav-emoji emoji">${e.emoji}</div></button>`),(e=>e.id))}</div><div class="indicator-wrapper"><div class="indicator" style="transform:translateX(${(t.isRtl?-1:1)*t.currentGroupIndex*100}%)"></div></div><div class="message ${t.message?"":"gone"}" role="alert" aria-live="polite">${t.message||""}</div><div data-ref="tabpanelElement" class="tabpanel ${!t.databaseLoaded||t.message?"gone":""}" role="${t.searchMode?"region":"tabpanel"}" aria-label="${t.searchMode?t.i18n.searchResultsLabel:t.i18n.categories[t.currentGroup.name]}" id="${t.searchMode?"":`tab-${t.currentGroup.id}`}" tabIndex="0" data-on-click="onEmojiClick"><div data-action="calculateEmojiGridStyle">${m(t.currentEmojisWithCategories,((e,o)=>u`<div><div id="menu-label-${o}" class="category ${1===t.currentEmojisWithCategories.length&&""===t.currentEmojisWithCategories[0].category?"gone":""}" aria-hidden="true">${t.searchMode?t.i18n.searchResultsLabel:e.category?e.category:t.currentEmojisWithCategories.length>1?t.i18n.categories.custom:t.i18n.categories[t.currentGroup.name]}</div><div class="emoji-menu ${0===o||t.searchMode||-1!==t.currentGroup.id?"":"visibility-auto"}" style="${`--num-rows: ${Math.ceil(e.emojis.length/t.numColumns)}`}" data-action="updateOnIntersection" role="${t.searchMode?"listbox":"menu"}" aria-labelledby="menu-label-${o}" id="${t.searchMode?"search-results":""}">${p(e.emojis,t.searchMode,"emo")}</div></div>`),(e=>e.category))}</div></div><div class="favorites onscreen emoji-menu ${t.message?"gone":""}" role="menu" aria-label="${t.i18n.favoritesLabel}" data-on-click="onEmojiClick">${p(t.currentFavorites,!1,"fav")}</div><button data-ref="baselineEmoji" aria-hidden="true" tabindex="-1" class="abs-pos hidden emoji baseline-emoji">😀</button></section>`,f=(t,o)=>{for(const i of e.querySelectorAll(`[${t}]`))o(i,i.getAttribute(t))};if(c){e.appendChild(g);for(const e of["click","focusout","input","keydown","keyup"])f(`data-on-${e}`,((t,o)=>{t.addEventListener(e,i[o])}));f("data-ref",((e,t)=>{n[t]=e})),r.addEventListener("abort",(()=>{e.removeChild(g)}))}f("data-action",((e,t)=>{let o=a.get(t);o||a.set(t,o=new WeakSet),o.has(e)||(o.add(e),s[t](e))}))}const xe="function"==typeof queueMicrotask?queueMicrotask:e=>Promise.resolve().then(e);function Ee(e,t,o){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!o(e[i],t[i]))return!1;return!0}const Se=new WeakMap;const Le=[],{assign:$e}=Object;function ze(e,t){const o={},i=new AbortController,s=i.signal,{state:n,createEffect:r}=function(e){let t,o=!1;const i=new Map,s=new Set;let n;const r=()=>{if(o)return;const e=[...s];s.clear();try{for(const t of e)t()}finally{n=!1,s.size&&(n=!0,xe(r))}},a=new Proxy({},{get(e,o){if(t){let e=i.get(o);e||(e=new Set,i.set(o,e)),e.add(t)}return e[o]},set(e,t,o){if(e[t]!==o){e[t]=o;const a=i.get(t);if(a){for(const e of a)s.add(e);n||(n=!0,xe(r))}}return!0}});return e.addEventListener("abort",(()=>{o=!0})),{state:a,createEffect:e=>{const o=()=>{const i=t;t=o;try{return e()}finally{t=i}};return o()}}}(s),a=new Map;$e(n,{skinToneEmoji:void 0,i18n:void 0,database:void 0,customEmoji:void 0,customCategorySorting:void 0,emojiVersion:void 0}),$e(n,t),$e(n,{initialLoad:!0,currentEmojis:[],currentEmojisWithCategories:[],rawSearchText:"",searchText:"",searchMode:!1,activeSearchItem:-1,message:void 0,skinTonePickerExpanded:!1,skinTonePickerExpandedAfterAnimation:!1,currentSkinTone:0,activeSkinTone:0,skinToneButtonText:void 0,pickerStyle:void 0,skinToneButtonLabel:"",skinTones:[],currentFavorites:[],defaultFavoriteEmojis:void 0,numColumns:8,isRtl:!1,currentGroupIndex:0,groups:J,databaseLoaded:!1,activeSearchItemId:void 0}),r((()=>{n.currentGroup!==n.groups[n.currentGroupIndex]&&(n.currentGroup=n.groups[n.currentGroupIndex])}));const c=t=>{e.getElementById(t).focus()},l=t=>e.getElementById(`emo-${t.id}`),d=(e,t)=>{o.rootElement.dispatchEvent(new CustomEvent(e,{detail:t,bubbles:!0,composed:!0}))},h=(e,t)=>e.id===t.id,u=(e,t)=>{const{category:o,emojis:i}=e,{category:s,emojis:n}=t;return o===s&&Ee(i,n,h)},m=e=>{Ee(n.currentEmojis,e,h)||(n.currentEmojis=e)},p=e=>{n.searchMode!==e&&(n.searchMode=e)},g=(e,t)=>t&&e.skins&&e.skins[t]||e.unicode,f={labelWithSkin:(e,t)=>{return(o=[e.name||g(e,t),e.annotation,...e.shortcodes||Le].filter(Boolean),le(o,(e=>e))).join(", ");var o},titleForEmoji:e=>e.annotation||(e.shortcodes||Le).join(", "),unicodeWithSkin:g},v={onClickSkinToneButton:function(e){n.skinTonePickerExpanded=!n.skinTonePickerExpanded,n.activeSkinTone=n.currentSkinTone,n.skinTonePickerExpanded&&(ae(e),de((()=>c("skintone-list"))))},onEmojiClick:async function(e){const{target:t}=e;if(!t.classList.contains("emoji"))return;ae(e);x(t.id.substring(4))},onNavClick:function(e){const{target:t}=e,i=t.closest(".nav-button");if(!i)return;const s=parseInt(i.dataset.groupId,10);o.searchElement.value="",n.rawSearchText="",n.searchText="",n.activeSearchItem=-1,n.currentGroupIndex=n.groups.findIndex((e=>e.id===s))},onNavKeydown:function(e){const{target:t,key:o}=e,i=t=>{t&&(ae(e),t.focus())};switch(o){case"ArrowLeft":return i(t.previousElementSibling);case"ArrowRight":return i(t.nextElementSibling);case"Home":return i(t.parentElement.firstElementChild);case"End":return i(t.parentElement.lastElementChild)}},onSearchKeydown:function(e){if(!n.searchMode||!n.currentEmojis.length)return;const t=t=>{ae(e),n.activeSearchItem=ce(t,n.activeSearchItem,n.currentEmojis)};switch(e.key){case"ArrowDown":return t(!1);case"ArrowUp":return t(!0);case"Enter":if(-1!==n.activeSearchItem)return ae(e),x(n.currentEmojis[n.activeSearchItem].id);n.activeSearchItem=0}},onSkinToneOptionsClick:function(e){const{target:{id:t}}=e,o=t&&t.match(/^skintone-(\d)/);if(!o)return;ae(e);E(parseInt(o[1],10))},onSkinToneOptionsFocusOut:async function(e){const{relatedTarget:t}=e;t&&"skintone-list"===t.id||(n.skinTonePickerExpanded=!1)},onSkinToneOptionsKeydown:function(e){if(!n.skinTonePickerExpanded)return;const t=async t=>{ae(e),n.activeSkinTone=t};switch(e.key){case"ArrowUp":return t(ce(!0,n.activeSkinTone,n.skinTones));case"ArrowDown":return t(ce(!1,n.activeSkinTone,n.skinTones));case"Home":return t(0);case"End":return t(n.skinTones.length-1);case"Enter":return ae(e),E(n.activeSkinTone);case"Escape":return ae(e),n.skinTonePickerExpanded=!1,c("skintone-button")}},onSkinToneOptionsKeyup:function(e){if(!n.skinTonePickerExpanded)return;if(" "===e.key)return ae(e),E(n.activeSkinTone)},onSearchInput:function(e){n.rawSearchText=e.target.value}},y={calculateEmojiGridStyle:function(e){!function(e,t,o){let i;ue?(i=new ResizeObserver(o),i.observe(e)):de(o),t.addEventListener("abort",(()=>{i&&i.disconnect()}))}(e,s,(()=>{{const e=getComputedStyle(o.rootElement),t=parseInt(e.getPropertyValue("--num-columns"),10),i="rtl"===e.getPropertyValue("direction");n.numColumns=t,n.isRtl=i}}))},updateOnIntersection:function(e){!function(e,t,o){{const i=e.closest(".tabpanel");let s=Se.get(i);s||(s=new IntersectionObserver(o,{root:i,rootMargin:"50% 0px 50% 0px",threshold:0}),Se.set(i,s),t.addEventListener("abort",(()=>{s.disconnect()}))),s.observe(e)}}(e,s,(e=>{for(const{target:t,isIntersecting:o}of e)t.classList.toggle("onscreen",o)}))}};let w=!0;function b(){const{customEmoji:e,database:t}=n,o=e||Le;t.customEmoji!==o&&(t.customEmoji=o)}r((()=>{_e(e,n,f,v,y,o,s,a,w),w=!1})),n.emojiVersion||ne().then((e=>{e||(n.message=n.i18n.emojiUnsupportedMessage)})),r((()=>{n.database&&async function(){let e=!1;const t=setTimeout((()=>{e=!0,n.message=n.i18n.loadingMessage}),1e3);try{await n.database.ready(),n.databaseLoaded=!0}catch(e){console.error(e),n.message=n.i18n.networkErrorMessage}finally{clearTimeout(t),e&&(e=!1,n.message="")}}()})),r((()=>{n.pickerStyle=`\n      --num-groups: ${n.groups.length}; \n      --indicator-opacity: ${n.searchMode?0:1}; \n      --num-skintones: 6;`})),r((()=>{n.customEmoji&&n.database&&b()})),r((()=>{n.customEmoji&&n.customEmoji.length?n.groups!==G&&(n.groups=G):n.groups!==J&&(n.currentGroupIndex&&n.currentGroupIndex--,n.groups=J)})),r((()=>{!async function(){n.databaseLoaded&&(n.currentSkinTone=await n.database.getPreferredSkinTone())}()})),r((()=>{n.skinTones=Array(6).fill().map(((e,t)=>function(e,t){if(0===t)return e;const o=e.indexOf("‍");return-1!==o?e.substring(0,o)+String.fromCodePoint(127995+t-1)+e.substring(o):(e.endsWith("️")&&(e=e.substring(0,e.length-1)),e+"\ud83c"+String.fromCodePoint(57339+t-1))}(n.skinToneEmoji,t)))})),r((()=>{n.skinToneButtonText=n.skinTones[n.currentSkinTone]})),r((()=>{n.skinToneButtonLabel=n.i18n.skinToneLabel.replace("{skinTone}",n.i18n.skinTones[n.currentSkinTone])})),r((()=>{n.databaseLoaded&&async function(){const{database:e}=n,t=(await Promise.all(Z.map((t=>e.getEmojiByUnicodeOrName(t))))).filter(Boolean);n.defaultFavoriteEmojis=t}()})),r((()=>{n.databaseLoaded&&n.defaultFavoriteEmojis&&async function(){b();const{database:e,defaultFavoriteEmojis:t,numColumns:o}=n,i=await e.getTopFavoriteEmoji(o),s=await _(le([...i,...t],(e=>e.unicode||e.name)).slice(0,o));n.currentFavorites=s}()})),r((()=>{!async function(){const{searchText:e,currentGroup:t,databaseLoaded:o,customEmoji:i}=n;if(o)if(e.length>=2){const t=await async function(e){return _(await C(await n.database.getEmojiBySearchQuery(e)))}(e);n.searchText===e&&(m(t),p(!0))}else{const{id:e}=t;if(-1!==e||i&&i.length){const t=await async function(e){const t=-1===e?n.customEmoji:await n.database.getEmojiByGroup(e);return _(await C(t))}(e);n.currentGroup.id===e&&(m(t),p(!1))}}else n.currentEmojis=[],n.searchMode=!1}()}));const k=()=>{de((()=>{var e;(e=o.tabpanelElement)&&(e.scrollTop=0)}))};function j(e){return!e.unicode||!Y(e)||re.get(e.unicode)}async function C(e){const t=n.emojiVersion||await ne();return e.filter((({version:e})=>!e||e<=t))}async function _(e){return function(e,t){const o=e=>{const o={};for(const i of e)"number"==typeof i.tone&&i.version<=t&&(o[i.tone]=i.unicode);return o};return e.map((({unicode:e,skins:t,shortcodes:i,url:s,name:n,category:r,annotation:a})=>({unicode:e,name:n,shortcodes:i,url:s,category:r,annotation:a,id:e||n,skins:t&&o(t)})))}(e,n.emojiVersion||await ne())}async function x(e){const t=await n.database.getEmojiByUnicodeOrName(e),o=[...n.currentEmojis,...n.currentFavorites].find((t=>t.id===e)),i=o.unicode&&g(o,n.currentSkinTone);await n.database.incrementFavoriteEmojiCount(e),d("emoji-click",{emoji:t,skinTone:n.currentSkinTone,...i&&{unicode:i},...o.name&&{name:o.name}})}function E(e){n.currentSkinTone=e,n.skinTonePickerExpanded=!1,c("skintone-button"),d("skin-tone-change",{skinTone:e}),n.database.setPreferredSkinTone(e)}return r((()=>{const{currentEmojis:e,emojiVersion:t}=n,i=e.filter((e=>e.unicode)).filter((e=>Y(e)&&!re.has(e.unicode)));if(!t&&i.length)m(e),de((()=>function(e){const t=function(e,t,o){let i=!0;for(const s of e){const e=me(o(s));void 0===he&&(he=me(t));const n=e/1.8<he;re.set(s.unicode,n),n||(i=!1)}return i}(e,o.baselineEmoji,l);t?k():n.currentEmojis=[...n.currentEmojis]}(i)));else{const o=t?e:e.filter(j);m(o),k()}})),r((()=>{})),r((()=>{const e=function(){const{searchMode:e,currentEmojis:t}=n;if(e)return[{category:"",emojis:t}];const o=new Map;for(const e of t){const t=e.category||"";let i=o.get(t);i||(i=[],o.set(t,i)),i.push(e)}return[...o.entries()].map((([e,t])=>({category:e,emojis:t}))).sort(((e,t)=>n.customCategorySorting(e.category,t.category)))}();(e=>{Ee(n.currentEmojisWithCategories,e,u)||(n.currentEmojisWithCategories=e)})(e)})),r((()=>{n.activeSearchItemId=-1!==n.activeSearchItem&&n.currentEmojis[n.activeSearchItem].id})),r((()=>{const{rawSearchText:e}=n;X((()=>{n.searchText=(e||"").trim(),n.activeSearchItem=-1}))})),r((()=>{n.skinTonePickerExpanded?o.skinToneDropdown.addEventListener("transitionend",(()=>{n.skinTonePickerExpandedAfterAnimation=!0}),{once:!0}):n.skinTonePickerExpandedAfterAnimation=!1})),{$set(e){$e(n,e)},$destroy(){i.abort()}}}var Pe={categoriesLabel:"Categories",emojiUnsupportedMessage:"Your browser does not support color emoji.",favoritesLabel:"Favorites",loadingMessage:"Loading…",networkErrorMessage:"Could not load emoji.",regionLabel:"Emoji picker",searchDescription:"When search results are available, press up or down to select and enter to choose.",searchLabel:"Search",searchResultsLabel:"Search results",skinToneDescription:"When expanded, press up or down to select and enter to choose.",skinToneLabel:"Choose a skin tone (currently {skinTone})",skinTonesLabel:"Skin tones",skinTones:["Default","Light","Medium-Light","Medium","Medium-Dark","Dark"],categories:{custom:"Custom","smileys-emotion":"Smileys and emoticons","people-body":"People and body","animals-nature":"Animals and nature","food-drink":"Food and drink","travel-places":"Travel and places",activities:"Activities",objects:"Objects",symbols:"Symbols",flags:"Flags"}};const Te=["customEmoji","customCategorySorting","database","dataSource","i18n","locale","skinToneEmoji","emojiVersion"],Ie=`:host{--emoji-font-family:${ee}}`;class Fe extends HTMLElement{constructor(e){super(),this.attachShadow({mode:"open"});const t=document.createElement("style");t.textContent=':host{--emoji-size:1.375rem;--emoji-padding:0.5rem;--category-emoji-size:var(--emoji-size);--category-emoji-padding:var(--emoji-padding);--indicator-height:3px;--input-border-radius:0.5rem;--input-border-size:1px;--input-font-size:1rem;--input-line-height:1.5;--input-padding:0.25rem;--num-columns:8;--outline-size:2px;--border-size:1px;--border-radius:0;--skintone-border-radius:1rem;--category-font-size:1rem;display:flex;width:min-content;height:400px}:host,:host(.light){color-scheme:light;--background:#fff;--border-color:#e0e0e0;--indicator-color:#385ac1;--input-border-color:#999;--input-font-color:#111;--input-placeholder-color:#999;--outline-color:#999;--category-font-color:#111;--button-active-background:#e6e6e6;--button-hover-background:#d9d9d9}:host(.dark){color-scheme:dark;--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}@media (prefers-color-scheme:dark){:host{color-scheme:dark;--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}}:host([hidden]){display:none}button{margin:0;padding:0;border:0;background:0 0;box-shadow:none;-webkit-tap-highlight-color:transparent}button::-moz-focus-inner{border:0}input{padding:0;margin:0;line-height:1.15;font-family:inherit}input[type=search]{-webkit-appearance:none}:focus{outline:var(--outline-color) solid var(--outline-size);outline-offset:calc(-1*var(--outline-size))}:host([data-js-focus-visible]) :focus:not([data-focus-visible-added]){outline:0}:focus:not(:focus-visible){outline:0}.hide-focus{outline:0}*{box-sizing:border-box}.picker{contain:content;display:flex;flex-direction:column;background:var(--background);border:var(--border-size) solid var(--border-color);border-radius:var(--border-radius);width:100%;height:100%;overflow:hidden;--total-emoji-size:calc(var(--emoji-size) + (2 * var(--emoji-padding)));--total-category-emoji-size:calc(var(--category-emoji-size) + (2 * var(--category-emoji-padding)))}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.hidden{opacity:0;pointer-events:none}.abs-pos{position:absolute;left:0;top:0}.gone{display:none!important}.skintone-button-wrapper,.skintone-list{background:var(--background);z-index:3}.skintone-button-wrapper.expanded{z-index:1}.skintone-list{position:absolute;inset-inline-end:0;top:0;z-index:2;overflow:visible;border-bottom:var(--border-size) solid var(--border-color);border-radius:0 0 var(--skintone-border-radius) var(--skintone-border-radius);will-change:transform;transition:transform .2s ease-in-out;transform-origin:center 0}@media (prefers-reduced-motion:reduce){.skintone-list{transition-duration:.001s}}@supports not (inset-inline-end:0){.skintone-list{right:0}}.skintone-list.no-animate{transition:none}.tabpanel{overflow-y:auto;scrollbar-gutter:stable;-webkit-overflow-scrolling:touch;will-change:transform;min-height:0;flex:1;contain:content}.emoji-menu{display:grid;grid-template-columns:repeat(var(--num-columns),var(--total-emoji-size));justify-content:space-around;align-items:flex-start;width:100%}.emoji-menu.visibility-auto{content-visibility:auto;contain-intrinsic-size:calc(var(--num-columns)*var(--total-emoji-size)) calc(var(--num-rows)*var(--total-emoji-size))}.category{padding:var(--emoji-padding);font-size:var(--category-font-size);color:var(--category-font-color)}.emoji,button.emoji{font-size:var(--emoji-size);display:flex;align-items:center;justify-content:center;border-radius:100%;height:var(--total-emoji-size);width:var(--total-emoji-size);line-height:1;overflow:hidden;font-family:var(--emoji-font-family);cursor:pointer}@media (hover:hover) and (pointer:fine){.emoji:hover,button.emoji:hover{background:var(--button-hover-background)}}.emoji.active,.emoji:active,button.emoji.active,button.emoji:active{background:var(--button-active-background)}.onscreen .custom-emoji::after{content:"";width:var(--emoji-size);height:var(--emoji-size);background-repeat:no-repeat;background-position:center center;background-size:contain;background-image:var(--custom-emoji-background)}.nav,.nav-button{align-items:center}.nav{display:grid;justify-content:space-between;contain:content}.nav-button{display:flex;justify-content:center}.nav-emoji{font-size:var(--category-emoji-size);width:var(--total-category-emoji-size);height:var(--total-category-emoji-size)}.indicator-wrapper{display:flex;border-bottom:1px solid var(--border-color)}.indicator{width:calc(100%/var(--num-groups));height:var(--indicator-height);opacity:var(--indicator-opacity);background-color:var(--indicator-color);will-change:transform,opacity;transition:opacity .1s linear,transform .25s ease-in-out}@media (prefers-reduced-motion:reduce){.indicator{will-change:opacity;transition:opacity .1s linear}}.pad-top,input.search{background:var(--background);width:100%}.pad-top{height:var(--emoji-padding);z-index:3}.search-row{display:flex;align-items:center;position:relative;padding-inline-start:var(--emoji-padding);padding-bottom:var(--emoji-padding)}.search-wrapper{flex:1;min-width:0}input.search{padding:var(--input-padding);border-radius:var(--input-border-radius);border:var(--input-border-size) solid var(--input-border-color);color:var(--input-font-color);font-size:var(--input-font-size);line-height:var(--input-line-height)}input.search::placeholder{color:var(--input-placeholder-color)}.favorites{overflow-y:auto;scrollbar-gutter:stable;display:flex;flex-direction:row;border-top:var(--border-size) solid var(--border-color);contain:content}.message{padding:var(--emoji-padding)}'+Ie,this.shadowRoot.appendChild(t),this._ctx={locale:"en",dataSource:"https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json",skinToneEmoji:"🖐️",customCategorySorting:te,customEmoji:null,i18n:Pe,emojiVersion:null,...e};for(const e of Te)"database"!==e&&Object.prototype.hasOwnProperty.call(this,e)&&(this._ctx[e]=this[e],delete this[e]);this._dbFlush()}connectedCallback(){this._cmp||(this._cmp=ze(this.shadowRoot,this._ctx))}disconnectedCallback(){xe((()=>{if(!this.isConnected&&this._cmp){this._cmp.$destroy(),this._cmp=void 0;const{database:e}=this._ctx;e.close().catch((e=>console.error(e)))}}))}static get observedAttributes(){return["locale","data-source","skin-tone-emoji","emoji-version"]}attributeChangedCallback(e,t,o){this._set(e.replace(/-([a-z])/g,((e,t)=>t.toUpperCase())),"emoji-version"===e?parseFloat(o):o)}_set(e,t){this._ctx[e]=t,this._cmp&&this._cmp.$set({[e]:t}),["locale","dataSource"].includes(e)&&this._dbFlush()}_dbCreate(){const{locale:e,dataSource:t,database:o}=this._ctx;o&&o.locale===e&&o.dataSource===t||this._set("database",new K({locale:e,dataSource:t}))}_dbFlush(){xe((()=>this._dbCreate()))}}const Be={};for(const e of Te)Be[e]={get(){return"database"===e&&this._dbCreate(),this._ctx[e]},set(t){if("database"===e)throw new Error("database is read-only");this._set(e,t)}};Object.defineProperties(Fe.prototype,Be),customElements.get("emoji-picker")||customElements.define("emoji-picker",Fe);class Ae{constructor(){this.saveIconClass="fa-bookmark",this.savedIconClass="fa-bookmark-o"}toggleSaveBugnoteIcon(e){const t=e.querySelector(".bugnote-save-icon");t&&(t.classList.contains(this.saveIconClass)?t.classList.replace(this.saveIconClass,this.savedIconClass):t.classList.replace(this.savedIconClass,this.saveIconClass))}createSaveBugnoteIcon(){const e=document.createElement("i");return e.classList.add("bugnote-icon","bugnote-save-icon","fa",this.savedIconClass),e}createReactionOnBugnoteIcon(){const e=document.createElement("i");return e.classList.add("bugnote-icon","fa","fa-smile-o","bugnote-reaction-icon"),e}}var Me=function(e,t,o,i){return new(o||(o=Promise))((function(s,n){function r(e){try{c(i.next(e))}catch(e){n(e)}}function a(e){try{c(i.throw(e))}catch(e){n(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,a)}c((i=i.apply(e,t||[])).next())}))};class Re{constructor(){this.settings=t,this.init()}init(){return Me(this,void 0,void 0,(function*(){this.settings=yield o(),yield this.getHighlightedBugnotes()}))}getHighlightedBugnotes(){return Me(this,void 0,void 0,(function*(){try{const e=yield fetch(this.settings.url,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:this.settings.actions.get_highlights,bugId:this.settings.bugId})});if(e.ok){return yield e.json()}console.error(`Error fetching issues: ${e.statusText}`)}catch(e){console.error(e)}return[]}))}getBugnotesTable(){const e=document.querySelectorAll("#bugnotes");return e.length<2?e[0]:e[1]}getBugnotesTableRows(){const e=this.getBugnotesTable();if(!e)return null;const t=Array.from(e.querySelectorAll(".category"));return 0===t.length?null:t}makeBugnoteHighlighted(e){e.parentElement.classList.toggle("highlighted")}}var Ne=(e,t,o)=>{if(!t.has(e))throw TypeError("Cannot "+o)},Oe=(e,t,o)=>(Ne(e,t,"read from private field"),o?o.call(e):t.get(e)),Ve=(e,t,o)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,o)},De=(e,t,o,i)=>(Ne(e,t,"write to private field"),i?i.call(e,o):t.set(e,o),o),He=(e,t,o)=>(Ne(e,t,"access private method"),o);async function Ue(e,t={}){const{local:o=!1,version:i="latest",cdnUrl:s,...n}=t,r=function(e,t,o){let i=`https://cdn.jsdelivr.net/npm/emojibase-data@${t}/${e}`;return"function"==typeof o?i=o(e,t):"string"==typeof o&&(i=`${o}/${e}`),i}(e,i,s),a=o?localStorage:sessionStorage,c=`emojibase/${i}/${e}`,l=a.getItem(c);if(l)return Promise.resolve(JSON.parse(l));const d=await fetch(r,{credentials:"omit",mode:"cors",redirect:"error",...n});if(!d.ok)throw new Error("Failed to load Emojibase dataset.");const h=await d.json();try{a.setItem(c,JSON.stringify(h))}catch{}return h}const We={discord:"joypixels",slack:"iamcal"};async function qe(e,t,o){var i;return Ue(`${e}/shortcodes/${null!==(i=We[t])&&void 0!==i?i:t}.json`,o)}function Ke(e,t){if(0===t.length)return e;const o=new Set(e.shortcodes);return t.forEach((t=>{const i=t[e.hexcode];Array.isArray(i)?i.forEach((e=>o.add(e))):i&&o.add(i)})),e.shortcodes=[...o],e.skins&&e.skins.forEach((e=>{Ke(e,t)})),e}async function Ge(e,t={}){const{compact:o=!1,flat:i=!1,shortcodes:s=[],...n}=t,r=await Ue(`${e}/${o?"compact":"data"}.json`,n);let a=[];return s.length>0&&(a=await Promise.all(s.map((t=>{let o;if(t.includes("/")){const[e,i]=t.split("/");o=qe(e,i,n)}else o=qe(e,t,n);return o.catch((()=>({})))})))),i?function(e,t=[]){const o=[];return e.forEach((e=>{if(e.skins){const{skins:i,...s}=e;o.push(Ke(s,t)),i.forEach((e=>{const i={...e};s.tags&&(i.tags=[...s.tags]),o.push(Ke(i,t))}))}else o.push(Ke(e,t))})),o}(r,a):function(e,t){return 0===t.length||e.forEach((e=>{Ke(e,t)})),e}(r,a)}async function Je(e,t){return Ue(`${e}/messages.json`,t)}function Xe(e,t){const o=e.target.closest("[data-emoji]");if(o){const e=t.find((e=>e.emoji===o.dataset.emoji));if(e)return e}return null}function Ye(e){var t;const o=null==(t=window.matchMedia)?void 0:t.call(window,"(prefers-reduced-motion: reduce)");return e.animate&&!(null!=o&&o.matches)}function Qe(e,t){return e.toLowerCase().includes(t.toLowerCase())}function Ze(e,t,o,i){if(Ye(i)&&e.animate)return e.animate(t,o).finished;const s="normal"===o.direction?1:0,n=Object.entries(t).reduce(((e,[t,o])=>({...e,[t]:o[s]})),{});return Object.assign(e.style,n),Promise.resolve()}function et(e){var t;const o=document.createElement("template");return o.innerHTML=e,null==(t=o.content)?void 0:t.firstElementChild}function tt(...e){return e.reduce(((e,t)=>({...e,[t]:ot(t)})),{})}function ot(e){return`picmo__${e}`}function it(e){for(;e.firstChild;)e.removeChild(e.firstChild);return e}function st(e,...t){it(e).append(...t)}function nt(e){try{return window[e].length,!0}catch{return!1}}function rt(){return nt("sessionStorage")}function at(e){var t;return{emoji:e.emoji,label:e.label,tags:e.tags,skins:null==(t=e.skins)?void 0:t.map((e=>at(e))),order:e.order,custom:!1,hexcode:e.hexcode,version:e.version}}function ct(e,t,o){var i;return!(o&&!o.some((t=>t.order===e.group)))&&(Qe(e.label,t)||(null==(i=e.tags)?void 0:i.some((e=>Qe(e,t)))))}class lt{constructor(e="en"){this.locale=e}}const dt=[(e,t)=>("1F91D"===e.hexcode&&t<14&&(e.skins=[]),e),(e,t)=>(e.skins&&(e.skins=e.skins.filter((e=>!e.version||e.version<=t))),e)];function ht(e,t){return e.filter((e=>null!==function(e,t){return dt.some((o=>null===o(e,t)))?null:e}(e,t)))}const ut={};function mt(e){return ut[e]||(ut[e]=new pt(e)),ut[e]}mt.deleteDatabase=e=>{};class pt extends lt{open(){return Promise.resolve()}delete(){return Promise.resolve()}close(){}isPopulated(){return Promise.resolve(!1)}getEmojiCount(){return Promise.resolve(this.emojis.length)}getEtags(){return Promise.resolve({foo:"bar"})}getHash(){return Promise.resolve("")}populate(e){return this.categories=e.groups,this.emojis=e.emojis,Promise.resolve()}getCategories(e){var t;let o=this.categories.filter((e=>"component"!==e.key));if(e.showRecents&&o.unshift({key:"recents",order:-1}),null!=(t=e.custom)&&t.length&&o.push({key:"custom",order:10}),e.categories){const t=e.categories;o=o.filter((e=>t.includes(e.key))),o.sort(((e,o)=>t.indexOf(e.key)-t.indexOf(o.key)))}else o.sort(((e,t)=>e.order-t.order));return Promise.resolve(o)}getEmojis(e,t){const o=this.emojis.filter((t=>t.group===e.order)).filter((e=>e.version<=t)).sort(((e,t)=>null!=e.order&&null!=t.order?e.order-t.order:0)).map(at);return Promise.resolve(ht(o,t))}searchEmojis(e,t,o,i){const s=this.emojis.filter((t=>ct(t,e,i)&&t.version<=o)).map(at),n=t.filter((t=>ct(t,e,i))),r=[...ht(s,o),...n];return Promise.resolve(r)}setMeta(e){this.meta=e}}async function gt(e){try{return(await fetch(e,{method:"HEAD"})).headers.get("etag")}catch{return null}}async function ft(e,t,o){let i=o||t(e);try{await i.open()}catch{console.warn("[picmo] IndexedDB not available, falling back to InMemoryStoreFactory"),i=mt(e)}return i}async function vt(e,t,o){if(!rt()&&typeof window<"u")throw new Error("Session storage is required to use CDN emoji data.");const i=await ft(e,t,o),[s,n]=await function(e){const{emojisUrl:t,messagesUrl:o}=function(e,t){const o=`https://cdn.jsdelivr.net/npm/emojibase-data@${"latest"}/${t}`;return{emojisUrl:`${o}/data.json`,messagesUrl:`${o}/messages.json`}}(0,e);try{return Promise.all([gt(t),gt(o)])}catch{return Promise.all([null,null])}}(e);if(await i.isPopulated())s&&n&&await async function(e,t,o){let i;try{i=await e.getEtags()}catch{i={}}const{storedEmojisEtag:s,storedMessagesEtag:n}=i;if(o!==n||t!==s){const[i,s]=await Promise.all([Je(e.locale),Ge(e.locale)]);await e.populate({groups:i.groups,emojis:s,emojisEtag:t,messagesEtag:o})}}(i,s,n);else{const[t,o]=await Promise.all([Je(e),Ge(e)]);await i.populate({groups:t.groups,emojis:o,emojisEtag:s,messagesEtag:n})}return i}async function yt(e,t,o,i,s){const n=await ft(e,t,s),r=await async function(e){const t=(new TextEncoder).encode(e),o=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(o)).map((e=>e.toString(16).padStart(2,"0"))).join("")}(i);return(!await n.isPopulated()||await async function(e,t){return t!==await e.getHash()}(n,r))&&await n.populate({groups:o.groups,emojis:i,hash:r}),n}async function wt(e,t,o,i,s){return o&&i?yt(e,t,o,i,s):vt(e,t,s)}class bt{constructor(){this.handleKeyDown=this.handleKeyDown.bind(this)}activate(e){this.rootElement=e,this.rootElement.addEventListener("keydown",this.handleKeyDown)}deactivate(){var e;null==(e=this.rootElement)||e.removeEventListener("keydown",this.handleKeyDown)}get focusableElements(){return this.rootElement.querySelectorAll('input, [tabindex="0"]')}get lastFocusableElement(){return this.focusableElements[this.focusableElements.length-1]}get firstFocusableElement(){return this.focusableElements[0]}checkFocus(e,t,o){e.target===t&&(o.focus(),e.preventDefault())}handleKeyDown(e){"Tab"===e.key&&this.checkFocus(e,e.shiftKey?this.firstFocusableElement:this.lastFocusableElement,e.shiftKey?this.lastFocusableElement:this.firstFocusableElement)}}const{light:kt,dark:jt,auto:Ct}=tt("light","dark","auto");class _t{constructor({template:e,classes:t,parent:o}){this.isDestroyed=!1,this.appEvents={},this.uiEvents=[],this.uiElements={},this.ui={},this.template=e,this.classes=t,this.parent=o,this.keyBindingHandler=this.keyBindingHandler.bind(this)}initialize(){this.bindAppEvents()}setCustomEmojis(e){this.customEmojis=e}setEvents(e){this.events=e}setPickerId(e){this.pickerId=e}emit(e,...t){this.events.emit(e,...t)}setI18n(e){this.i18n=e}setRenderer(e){this.renderer=e}setEmojiData(e){this.emojiDataPromise=e,e.then((e=>{this.emojiData=e}))}updateEmojiData(e){this.emojiData=e,this.emojiDataPromise=Promise.resolve(e)}setOptions(e){this.options=e}renderSync(e={}){return this.el=this.template.renderSync({classes:this.classes,i18n:this.i18n,pickerId:this.pickerId,...e}),this.postRender(),this.el}async render(e={}){return await this.emojiDataPromise,this.el=await this.template.renderAsync({classes:this.classes,i18n:this.i18n,pickerId:this.pickerId,...e}),this.postRender(),this.el}postRender(){this.bindUIElements(),this.bindKeyBindings(),this.bindUIEvents(),this.scheduleShowAnimation()}bindAppEvents(){Object.keys(this.appEvents).forEach((e=>{this.events.on(e,this.appEvents[e],this)})),this.events.on("data:ready",this.updateEmojiData,this)}unbindAppEvents(){Object.keys(this.appEvents).forEach((e=>{this.events.off(e,this.appEvents[e])})),this.events.off("data:ready",this.updateEmojiData)}keyBindingHandler(e){const t=this.keyBindings[e.key];t&&t.call(this,e)}bindKeyBindings(){this.keyBindings&&this.el.addEventListener("keydown",this.keyBindingHandler)}unbindKeyBindings(){this.keyBindings&&this.el.removeEventListener("keydown",this.keyBindingHandler)}bindUIElements(){this.ui=Object.keys(this.uiElements).reduce(((e,t)=>({...e,[t]:this.el.querySelector(this.uiElements[t])})),{})}bindUIEvents(){this.uiEvents.forEach((e=>{e.handler=e.handler.bind(this),(e.target?this.ui[e.target]:this.el).addEventListener(e.event,e.handler,e.options)}))}unbindUIEvents(){this.uiEvents.forEach((e=>{(e.target?this.ui[e.target]:this.el).removeEventListener(e.event,e.handler)}))}destroy(){this.unbindAppEvents(),this.unbindUIEvents(),this.unbindKeyBindings(),this.el.remove(),this.isDestroyed=!0}scheduleShowAnimation(){if(this.parent){const e=new MutationObserver((t=>{const[o]=t;"childList"===o.type&&o.addedNodes[0]===this.el&&(Ye(this.options)&&this.animateShow&&this.animateShow(),e.disconnect)}));e.observe(this.parent,{childList:!0})}}static childEvent(e,t,o,i={}){return{target:e,event:t,handler:o,options:i}}static uiEvent(e,t,o={}){return{event:e,handler:t,options:o}}static byClass(e){return`.${e}`}}const xt={clock:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M256 512C114.6 512 0 397.4 0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256C512 397.4 397.4 512 256 512zM232 256C232 264 236 271.5 242.7 275.1L338.7 339.1C349.7 347.3 364.6 344.3 371.1 333.3C379.3 322.3 376.3 307.4 365.3 300L280 243.2V120C280 106.7 269.3 96 255.1 96C242.7 96 231.1 106.7 231.1 120L232 256z"/></svg>',flag:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M64 496C64 504.8 56.75 512 48 512h-32C7.25 512 0 504.8 0 496V32c0-17.75 14.25-32 32-32s32 14.25 32 32V496zM476.3 0c-6.365 0-13.01 1.35-19.34 4.233c-45.69 20.86-79.56 27.94-107.8 27.94c-59.96 0-94.81-31.86-163.9-31.87C160.9 .3055 131.6 4.867 96 15.75v350.5c32-9.984 59.87-14.1 84.85-14.1c73.63 0 124.9 31.78 198.6 31.78c31.91 0 68.02-5.971 111.1-23.09C504.1 355.9 512 344.4 512 332.1V30.73C512 11.1 495.3 0 476.3 0z"/></svg>',frown:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256C512 397.4 397.4 512 256 512C114.6 512 0 397.4 0 256zM176.4 240C194 240 208.4 225.7 208.4 208C208.4 190.3 194 176 176.4 176C158.7 176 144.4 190.3 144.4 208C144.4 225.7 158.7 240 176.4 240zM336.4 176C318.7 176 304.4 190.3 304.4 208C304.4 225.7 318.7 240 336.4 240C354 240 368.4 225.7 368.4 208C368.4 190.3 354 176 336.4 176zM259.9 369.4C288.8 369.4 316.2 375.2 340.6 385.5C352.9 390.7 366.7 381.3 361.4 369.1C344.8 330.9 305.6 303.1 259.9 303.1C214.3 303.1 175.1 330.8 158.4 369.1C153.1 381.3 166.1 390.6 179.3 385.4C203.7 375.1 231 369.4 259.9 369.4L259.9 369.4z"/></svg>',gamepad:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M448 64H192C85.96 64 0 149.1 0 256s85.96 192 192 192h256c106 0 192-85.96 192-192S554 64 448 64zM247.1 280h-32v32c0 13.2-10.78 24-23.98 24c-13.2 0-24.02-10.8-24.02-24v-32L136 279.1C122.8 279.1 111.1 269.2 111.1 256c0-13.2 10.85-24.01 24.05-24.01L167.1 232v-32c0-13.2 10.82-24 24.02-24c13.2 0 23.98 10.8 23.98 24v32h32c13.2 0 24.02 10.8 24.02 24C271.1 269.2 261.2 280 247.1 280zM431.1 344c-22.12 0-39.1-17.87-39.1-39.1s17.87-40 39.1-40s39.1 17.88 39.1 40S454.1 344 431.1 344zM495.1 248c-22.12 0-39.1-17.87-39.1-39.1s17.87-40 39.1-40c22.12 0 39.1 17.88 39.1 40S518.1 248 495.1 248z"/></svg>',lightbulb:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M112.1 454.3c0 6.297 1.816 12.44 5.284 17.69l17.14 25.69c5.25 7.875 17.17 14.28 26.64 14.28h61.67c9.438 0 21.36-6.401 26.61-14.28l17.08-25.68c2.938-4.438 5.348-12.37 5.348-17.7L272 415.1h-160L112.1 454.3zM191.4 .0132C89.44 .3257 16 82.97 16 175.1c0 44.38 16.44 84.84 43.56 115.8c16.53 18.84 42.34 58.23 52.22 91.45c.0313 .25 .0938 .5166 .125 .7823h160.2c.0313-.2656 .0938-.5166 .125-.7823c9.875-33.22 35.69-72.61 52.22-91.45C351.6 260.8 368 220.4 368 175.1C368 78.61 288.9-.2837 191.4 .0132zM192 96.01c-44.13 0-80 35.89-80 79.1C112 184.8 104.8 192 96 192S80 184.8 80 176c0-61.76 50.25-111.1 112-111.1c8.844 0 16 7.159 16 16S200.8 96.01 192 96.01z"/></svg>',mug:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M512 32H120c-13.25 0-24 10.75-24 24L96.01 288c0 53 43 96 96 96h192C437 384 480 341 480 288h32c70.63 0 128-57.38 128-128S582.6 32 512 32zM512 224h-32V96h32c35.25 0 64 28.75 64 64S547.3 224 512 224zM560 416h-544C7.164 416 0 423.2 0 432C0 458.5 21.49 480 48 480h480c26.51 0 48-21.49 48-48C576 423.2 568.8 416 560 416z"/></svg>',plane:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M482.3 192C516.5 192 576 221 576 256C576 292 516.5 320 482.3 320H365.7L265.2 495.9C259.5 505.8 248.9 512 237.4 512H181.2C170.6 512 162.9 501.8 165.8 491.6L214.9 320H112L68.8 377.6C65.78 381.6 61.04 384 56 384H14.03C6.284 384 0 377.7 0 369.1C0 368.7 .1818 367.4 .5398 366.1L32 256L.5398 145.9C.1818 144.6 0 143.3 0 142C0 134.3 6.284 128 14.03 128H56C61.04 128 65.78 130.4 68.8 134.4L112 192H214.9L165.8 20.4C162.9 10.17 170.6 0 181.2 0H237.4C248.9 0 259.5 6.153 265.2 16.12L365.7 192H482.3z"/></svg>',robot:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M9.375 233.4C3.375 239.4 0 247.5 0 256v128c0 8.5 3.375 16.62 9.375 22.62S23.5 416 32 416h32V224H32C23.5 224 15.38 227.4 9.375 233.4zM464 96H352V32c0-17.62-14.38-32-32-32S288 14.38 288 32v64H176C131.8 96 96 131.8 96 176V448c0 35.38 28.62 64 64 64h320c35.38 0 64-28.62 64-64V176C544 131.8 508.3 96 464 96zM256 416H192v-32h64V416zM224 296C201.9 296 184 278.1 184 256S201.9 216 224 216S264 233.9 264 256S246.1 296 224 296zM352 416H288v-32h64V416zM448 416h-64v-32h64V416zM416 296c-22.12 0-40-17.88-40-40S393.9 216 416 216S456 233.9 456 256S438.1 296 416 296zM630.6 233.4C624.6 227.4 616.5 224 608 224h-32v192h32c8.5 0 16.62-3.375 22.62-9.375S640 392.5 640 384V256C640 247.5 636.6 239.4 630.6 233.4z"/></svg>',sad:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">\n  <defs>\n    <radialGradient gradientUnits="userSpaceOnUse" cy="10%" id="gradient-0">\n      <stop offset="0" stop-color="hsl(50, 100%, 50%)" />\n      <stop offset="1" stop-color="hsl(50, 100%, 60%)" />\n    </radialGradient>\n  </defs>\n  \x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e\n  <ellipse stroke="#000" fill="rgba(0, 0, 0, 0.6)" cx="172.586" cy="207.006" rx="39.974" ry="39.974"/>\n  <ellipse stroke="#000" fill="rgba(0, 0, 0, 0.6)" cx="334.523" cy="207.481" rx="39.974" ry="39.974"/>\n  <ellipse stroke="#000" fill="rgba(0, 0, 0, 0.6)" cx="313.325" cy="356.208" rx="91.497" ry="59.893"/>\n  <path fill="#55a7ff" d="M 159.427 274.06 L 102.158 363.286 L 124.366 417.011 L 160.476 423.338 L 196.937 414.736 L 218.502 375.214"></path>\n  <path fill="url(#gradient-0)" d="M256 0C397.4 0 512 114.6 512 256C512 397.4 397.4 512 256 512C114.6 512 0 397.4 0 256C0 114.6 114.6 0 256 0zM256 352C290.9 352 323.2 367.8 348.3 394.9C354.3 401.4 364.4 401.7 370.9 395.7C377.4 389.7 377.7 379.6 371.7 373.1C341.6 340.5 301 320 256 320C247.2 320 240 327.2 240 336C240 344.8 247.2 352 256 352H256zM208 369C208 349 179.6 308.6 166.4 291.3C163.2 286.9 156.8 286.9 153.6 291.3C140.6 308.6 112 349 112 369C112 395 133.5 416 160 416C186.5 416 208 395 208 369H208zM303.6 208C303.6 225.7 317.1 240 335.6 240C353.3 240 367.6 225.7 367.6 208C367.6 190.3 353.3 176 335.6 176C317.1 176 303.6 190.3 303.6 208zM207.6 208C207.6 190.3 193.3 176 175.6 176C157.1 176 143.6 190.3 143.6 208C143.6 225.7 157.1 240 175.6 240C193.3 240 207.6 225.7 207.6 208z" />\n</svg>',search:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M500.3 443.7l-119.7-119.7c27.22-40.41 40.65-90.9 33.46-144.7C401.8 87.79 326.8 13.32 235.2 1.723C99.01-15.51-15.51 99.01 1.724 235.2c11.6 91.64 86.08 166.7 177.6 178.9c53.8 7.189 104.3-6.236 144.7-33.46l119.7 119.7c15.62 15.62 40.95 15.62 56.57 0C515.9 484.7 515.9 459.3 500.3 443.7zM79.1 208c0-70.58 57.42-128 128-128s128 57.42 128 128c0 70.58-57.42 128-128 128S79.1 278.6 79.1 208z"/></svg>',smiley:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256C512 397.4 397.4 512 256 512C114.6 512 0 397.4 0 256zM256.3 331.8C208.9 331.8 164.1 324.9 124.5 312.8C112.2 309 100.2 319.7 105.2 331.5C130.1 390.6 188.4 432 256.3 432C324.2 432 382.4 390.6 407.4 331.5C412.4 319.7 400.4 309 388.1 312.8C348.4 324.9 303.7 331.8 256.3 331.8H256.3zM176.4 176C158.7 176 144.4 190.3 144.4 208C144.4 225.7 158.7 240 176.4 240C194 240 208.4 225.7 208.4 208C208.4 190.3 194 176 176.4 176zM336.4 240C354 240 368.4 225.7 368.4 208C368.4 190.3 354 176 336.4 176C318.7 176 304.4 190.3 304.4 208C304.4 225.7 318.7 240 336.4 240z"/></svg>',symbols:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M500.3 7.251C507.7 13.33 512 22.41 512 31.1V175.1C512 202.5 483.3 223.1 447.1 223.1C412.7 223.1 383.1 202.5 383.1 175.1C383.1 149.5 412.7 127.1 447.1 127.1V71.03L351.1 90.23V207.1C351.1 234.5 323.3 255.1 287.1 255.1C252.7 255.1 223.1 234.5 223.1 207.1C223.1 181.5 252.7 159.1 287.1 159.1V63.1C287.1 48.74 298.8 35.61 313.7 32.62L473.7 .6198C483.1-1.261 492.9 1.173 500.3 7.251H500.3zM74.66 303.1L86.5 286.2C92.43 277.3 102.4 271.1 113.1 271.1H174.9C185.6 271.1 195.6 277.3 201.5 286.2L213.3 303.1H239.1C266.5 303.1 287.1 325.5 287.1 351.1V463.1C287.1 490.5 266.5 511.1 239.1 511.1H47.1C21.49 511.1-.0019 490.5-.0019 463.1V351.1C-.0019 325.5 21.49 303.1 47.1 303.1H74.66zM143.1 359.1C117.5 359.1 95.1 381.5 95.1 407.1C95.1 434.5 117.5 455.1 143.1 455.1C170.5 455.1 191.1 434.5 191.1 407.1C191.1 381.5 170.5 359.1 143.1 359.1zM440.3 367.1H496C502.7 367.1 508.6 372.1 510.1 378.4C513.3 384.6 511.6 391.7 506.5 396L378.5 508C372.9 512.1 364.6 513.3 358.6 508.9C352.6 504.6 350.3 496.6 353.3 489.7L391.7 399.1H336C329.3 399.1 323.4 395.9 321 389.6C318.7 383.4 320.4 376.3 325.5 371.1L453.5 259.1C459.1 255 467.4 254.7 473.4 259.1C479.4 263.4 481.6 271.4 478.7 278.3L440.3 367.1zM116.7 219.1L19.85 119.2C-8.112 90.26-6.614 42.31 24.85 15.34C51.82-8.137 93.26-3.642 118.2 21.83L128.2 32.32L137.7 21.83C162.7-3.642 203.6-8.137 231.6 15.34C262.6 42.31 264.1 90.26 236.1 119.2L139.7 219.1C133.2 225.6 122.7 225.6 116.7 219.1H116.7z"/></svg>',tree:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M413.8 447.1L256 448l0 31.99C256 497.7 241.8 512 224.1 512c-17.67 0-32.1-14.32-32.1-31.99l0-31.99l-158.9-.0099c-28.5 0-43.69-34.49-24.69-56.4l68.98-79.59H62.22c-25.41 0-39.15-29.8-22.67-49.13l60.41-70.85H89.21c-21.28 0-32.87-22.5-19.28-37.31l134.8-146.5c10.4-11.3 28.22-11.3 38.62-.0033l134.9 146.5c13.62 14.81 2.001 37.31-19.28 37.31h-10.77l60.35 70.86c16.46 19.34 2.716 49.12-22.68 49.12h-15.2l68.98 79.59C458.7 413.7 443.1 447.1 413.8 447.1z"/></svg>',users:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M224 256c70.7 0 128-57.31 128-128S294.7 0 224 0C153.3 0 96 57.31 96 128S153.3 256 224 256zM274.7 304H173.3c-95.73 0-173.3 77.6-173.3 173.3C0 496.5 15.52 512 34.66 512H413.3C432.5 512 448 496.5 448 477.3C448 381.6 370.4 304 274.7 304zM479.1 320h-73.85C451.2 357.7 480 414.1 480 477.3C480 490.1 476.2 501.9 470 512h138C625.7 512 640 497.6 640 479.1C640 391.6 568.4 320 479.1 320zM432 256C493.9 256 544 205.9 544 144S493.9 32 432 32c-25.11 0-48.04 8.555-66.72 22.51C376.8 76.63 384 101.4 384 128c0 35.52-11.93 68.14-31.59 94.71C372.7 243.2 400.8 256 432 256z"/></svg>',warning:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">\n  <defs>\n    <radialGradient id="radial" cy="85%">\n      <stop offset="20%" stop-color="var(--color-secondary)" />\n      <stop offset="100%" stop-color="var(--color-primary)" />\n    </radialGradient>\n  </defs>\n  \x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e\n  <path fill="url(\'#radial\')" d="M506.3 417l-213.3-364c-16.33-28-57.54-28-73.98 0l-213.2 364C-10.59 444.9 9.849 480 42.74 480h426.6C502.1 480 522.6 445 506.3 417zM232 168c0-13.25 10.75-24 24-24S280 154.8 280 168v128c0 13.25-10.75 24-23.1 24S232 309.3 232 296V168zM256 416c-17.36 0-31.44-14.08-31.44-31.44c0-17.36 14.07-31.44 31.44-31.44s31.44 14.08 31.44 31.44C287.4 401.9 273.4 416 256 416z" />\n</svg>',xmark:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>'},Et={recents:"clock","smileys-emotion":"smiley","people-body":"users","animals-nature":"tree","food-drink":"mug",activities:"gamepad","travel-places":"plane",objects:"lightbulb",symbols:"symbols",flags:"flag",custom:"robot"};function St(e,t){if(!(e in xt))return console.warn(`Unknown icon: "${e}"`),document.createElement("div");const o=function(e,t){const o=et(t);return o.dataset.icon=e,o.classList.add(ot("icon")),o}(e,xt[e]);return t&&o.classList.add(ot(`icon-${t}`)),o}const Lt="sync";var $t,zt,Pt,Tt,It,Ft,Bt,At;class Mt{constructor(e,t={}){Ve(this,Pt),Ve(this,It),Ve(this,Bt),Ve(this,$t,void 0),Ve(this,zt,void 0),De(this,$t,e),De(this,zt,t.mode||Lt)}renderSync(e={}){const t=et(Oe(this,$t).call(this,e));return He(this,Bt,At).call(this,t,e),He(this,It,Ft).call(this,t),He(this,Pt,Tt).call(this,t,e),t}async renderAsync(e={}){const t=et(Oe(this,$t).call(this,e));return He(this,Bt,At).call(this,t,e),He(this,It,Ft).call(this,t),await He(this,Pt,Tt).call(this,t,e),t}render(e){return"sync"===Oe(this,zt)?this.renderSync(e):this.renderAsync(e)}}$t=new WeakMap,zt=new WeakMap,Pt=new WeakSet,Tt=async function(e,t){const o=e.querySelectorAll("[data-view]"),i=[];for(const e of o){const o=t[e.dataset.view];o?"sync"!==e.dataset.render?i.push(o.render().then((t=>(e.replaceWith(t),t)))):e.replaceWith(o.renderSync()):e.remove()}return Promise.all(i)},It=new WeakSet,Ft=function(e){e.querySelectorAll("i[data-icon]").forEach((e=>{const{icon:t,size:o}=e.dataset;e.replaceWith(St(t,o))}))},Bt=new WeakSet,At=function(e,t){return e.querySelectorAll("[data-placeholder]").forEach((e=>{const o=e.dataset.placeholder;if(o&&t[o]){const i=t[o];e.replaceWith(...[i].flat())}else console.warn(`Missing placeholder element for key "${o}"`)})),e};const Rt=tt("imagePlaceholder","placeholder"),Nt=new Mt((({classes:e})=>`\n  <div class="${e.placeholder} ${e.imagePlaceholder}"></div>\n`));class Ot extends _t{constructor({classNames:e}={}){super({template:Nt,classes:Rt}),this.classNames=e}load(e){const t=document.createElement("img");this.classNames&&(t.className=this.classNames),t.addEventListener("load",(()=>{this.el.replaceWith(t)}),{once:!0}),Promise.resolve(e).then((e=>t.src=e))}renderSync(){return super.renderSync(),this.classNames&&this.classNames.split(" ").forEach((e=>this.el.classList.add(e))),this.el}}const Vt=tt("customEmoji");class Dt{renderElement(e){return{content:e}}renderImage(e="",t){const o=new Ot({classNames:e});return o.renderSync(),{content:o,resolver:()=>(o.load(t()),o.el)}}doRender(e,t,o){if(e.custom)return this.renderCustom(e,t,o);const{content:i,resolver:s}=this.render(e,o),n=i instanceof Element?i:i.el;return s&&s(),n}doEmit(e){return e.custom?this.emitCustom(e):this.emit(e)}emitCustom({url:e,label:t,emoji:o,data:i}){return{url:e,label:t,emoji:o,data:i}}renderCustom(e,t,o=""){const i=[Vt.customEmoji,o].join(" ").trim(),{content:s,resolver:n}=this.renderImage(i,(()=>e.url)),r=s instanceof Element?s:s.el;return n&&n(),r}}const Ht=new Mt((({emoji:e})=>`<span>${e}</span>`));class Ut extends Dt{render(e){return this.renderElement(Ht.renderSync({emoji:e.emoji}))}emit({emoji:e,hexcode:t,label:o}){return{emoji:e,hexcode:t,label:o}}}const Wt={"categories.activities":"Activities","categories.animals-nature":"Animals & Nature","categories.custom":"Custom","categories.flags":"Flags","categories.food-drink":"Food & Drink","categories.objects":"Objects","categories.people-body":"People & Body","categories.recents":"Recently Used","categories.smileys-emotion":"Smileys & Emotion","categories.symbols":"Symbols","categories.travel-places":"Travel & Places","error.load":"Failed to load emojis","recents.clear":"Clear recent emojis","recents.none":"You haven't selected any emojis yet.",retry:"Try again","search.clear":"Clear search","search.error":"Failed to search emojis","search.notFound":"No results found",search:"Search emojis..."},qt="PicMo";function Kt(e){return new Gt(e)}Kt.deleteDatabase=e=>new Promise(((t,o)=>{const i=indexedDB.deleteDatabase(`${qt}-${e}`);i.addEventListener("success",t),i.addEventListener("error",o)}));class Gt extends lt{async open(){const e=indexedDB.open(`${qt}-${this.locale}`);return new Promise(((t,o)=>{e.addEventListener("success",(e=>{var o;this.db=null==(o=e.target)?void 0:o.result,t()})),e.addEventListener("error",o),e.addEventListener("upgradeneeded",(async e=>{var t;this.db=null==(t=e.target)?void 0:t.result,this.db.createObjectStore("category",{keyPath:"order"});const o=this.db.createObjectStore("emoji",{keyPath:"emoji"});o.createIndex("category","group"),o.createIndex("version","version"),this.db.createObjectStore("meta")}))}))}async delete(){this.close();const e=indexedDB.deleteDatabase(`${qt}-${this.locale}`);await this.waitForRequest(e)}close(){this.db.close()}async getEmojiCount(){const e=this.db.transaction("emoji","readonly").objectStore("emoji");return(await this.waitForRequest(e.count())).target.result}async getEtags(){const e=this.db.transaction("meta","readonly").objectStore("meta"),[t,o]=await Promise.all([this.waitForRequest(e.get("emojisEtag")),this.waitForRequest(e.get("messagesEtag"))]);return{storedEmojisEtag:t.target.result,storedMessagesEtag:o.target.result}}async setMeta(e){const t=this.db.transaction("meta","readwrite"),o=t.objectStore("meta");return new Promise((i=>{t.oncomplete=i,Object.keys(e).filter(Boolean).forEach((t=>{o.put(e[t],t)}))}))}async getHash(){const e=this.db.transaction("meta","readonly").objectStore("meta");return(await this.waitForRequest(e.get("hash"))).target.result}async isPopulated(){const e=this.db.transaction("category","readonly").objectStore("category");return(await this.waitForRequest(e.count())).target.result>0}async populate({groups:e,emojis:t,emojisEtag:o,messagesEtag:i,hash:s}){await this.removeAllObjects("category","emoji");const n=[this.addObjects("category",e),this.addObjects("emoji",t),this.setMeta({emojisEtag:o,messagesEtag:i,hash:s})];await Promise.all(n)}async getCategories(e){var t;const o=this.db.transaction("category","readonly").objectStore("category");let i=(await this.waitForRequest(o.getAll())).target.result.filter((e=>"component"!==e.key));if(e.showRecents&&i.unshift({key:"recents",order:-1}),null!=(t=e.custom)&&t.length&&i.push({key:"custom",order:10}),e.categories){const t=e.categories;i=i.filter((e=>t.includes(e.key))),i.sort(((e,o)=>t.indexOf(e.key)-t.indexOf(o.key)))}else i.sort(((e,t)=>e.order-t.order));return i}async getEmojis(e,t){const o=this.db.transaction("emoji","readonly").objectStore("emoji").index("category");return ht((await this.waitForRequest(o.getAll(e.order))).target.result.filter((e=>e.version<=t)).sort(((e,t)=>null!=e.order&&null!=t.order?e.order-t.order:0)).map(at),t)}async searchEmojis(e,t,o,i){const s=[];return new Promise(((n,r)=>{const a=this.db.transaction("emoji","readonly").objectStore("emoji").openCursor();a.addEventListener("success",(r=>{var a;const c=null==(a=r.target)?void 0:a.result;if(!c)return n([...ht(s,o),...t.filter((t=>ct(t,e)))]);const l=c.value;ct(l,e,i)&&l.version<=o&&s.push(at(l)),c.continue()})),a.addEventListener("error",(e=>{r(e)}))}))}async waitForRequest(e){return new Promise(((t,o)=>{e.onsuccess=t,e.onerror=o}))}withTransaction(e,t="readwrite",o){return new Promise(((i,s)=>{const n=this.db.transaction(e,t);n.oncomplete=i,n.onerror=s,o(n)}))}async removeAllObjects(...e){const t=this.db.transaction(e,"readwrite"),o=e.map((e=>t.objectStore(e)));await Promise.all(o.map((e=>this.waitForRequest(e.clear()))))}async addObjects(e,t){return this.withTransaction(e,"readwrite",(o=>{const i=o.objectStore(e);t.forEach((e=>{i.add(e)}))}))}}function Jt(){let e={};return{getItem:t=>e[t],setItem:(t,o)=>e[t]=o,length:Object.keys(e).length,clear:()=>e={},key:t=>Object.keys(e)[t],removeItem:t=>delete e[t]}}class Xt{}const Yt="PicMo:recents";class Qt extends Xt{constructor(e){super(),this.storage=e}clear(){this.storage.removeItem(Yt)}getRecents(e){var t;try{return JSON.parse(null!=(t=this.storage.getItem(Yt))?t:"[]").slice(0,e)}catch{return[]}}addOrUpdateRecent(e,t){const o=[e,...this.getRecents(t).filter((t=>t.hexcode!==e.hexcode))].slice(0,t);try{this.storage.setItem(Yt,JSON.stringify(o))}catch{console.warn("storage is not available, recent emojis will not be saved")}}}class Zt extends Qt{constructor(){super(nt("localStorage")?localStorage:Jt())}}const eo={dataStore:Kt,theme:kt,animate:!0,showCategoryTabs:!0,showPreview:!0,showRecents:!0,showSearch:!0,showVariants:!0,emojisPerRow:8,visibleRows:6,emojiVersion:"auto",i18n:Wt,locale:"en",maxRecents:50,custom:[]};var to,oo,io,so,no;class ro{constructor(){Ve(this,oo),Ve(this,so),Ve(this,to,new Map)}on(e,t,o){He(this,so,no).call(this,e,t,o)}once(e,t,o){He(this,so,no).call(this,e,t,o,!0)}off(e,t){const o=He(this,oo,io).call(this,e);Oe(this,to).set(e,o.filter((e=>e.handler!==t)))}emit(e,...t){He(this,oo,io).call(this,e).forEach((o=>{o.handler.apply(o.context,t),o.once&&this.off(e,o.handler)}))}removeAll(){Oe(this,to).clear()}}to=new WeakMap,oo=new WeakSet,io=function(e){return Oe(this,to).has(e)||Oe(this,to).set(e,[]),Oe(this,to).get(e)},so=new WeakSet,no=function(e,t,o,i=!1){He(this,oo,io).call(this,e).push({context:o,handler:t,once:i})};const ao=!0;class co extends ro{}class lo extends ro{}const ho=tt("emojiCategory","categoryName","noRecents","recentEmojis");class uo extends _t{constructor({template:e,category:t,showVariants:o,lazyLoader:i}){super({template:e,classes:ho}),this.baseUIElements={categoryName:_t.byClass(ho.categoryName)},this.category=t,this.showVariants=o,this.lazyLoader=i}setActive(e,t,o){this.emojiContainer.setActive(e,t,o)}}const mo=new Mt((({classes:e,emoji:t})=>`\n  <button\n    type="button"\n    class="${e.emojiButton}"\n    title="${t.label}"\n    data-emoji="${t.emoji}"\n    tabindex="-1">\n    <div data-placeholder="emojiContent"></div>\n  </button>\n`)),po=tt("emojiButton");class go extends _t{constructor({emoji:e,lazyLoader:t,category:o}){super({template:mo,classes:po}),this.emoji=e,this.lazyLoader=t,this.category=o}initialize(){this.uiEvents=[_t.uiEvent("focus",this.handleFocus)],super.initialize()}handleFocus(){this.category&&this.events.emit("focus:change",this.category)}activateFocus(e){this.el.tabIndex=0,e&&this.el.focus()}deactivateFocus(){this.el.tabIndex=-1}renderSync(){return super.renderSync({emoji:this.emoji,emojiContent:this.renderer.doRender(this.emoji,this.lazyLoader)})}}class fo{constructor(e,t,o=0,i=0,s=!1){this.events=new ro,this.keyHandlers={ArrowLeft:this.focusPrevious.bind(this),ArrowRight:this.focusNext.bind(this),ArrowUp:this.focusUp.bind(this),ArrowDown:this.focusDown.bind(this)},this.rowCount=Math.ceil(t/e),this.columnCount=e,this.focusedRow=o,this.focusedColumn=i,this.emojiCount=t,this.wrap=s,this.handleKeyDown=this.handleKeyDown.bind(this)}destroy(){this.events.removeAll()}on(e,t){this.events.on(e,t)}handleKeyDown(e){e.key in this.keyHandlers&&(e.preventDefault(),this.keyHandlers[e.key]())}setCell(e,t,o=!0){const i=this.getIndex();this.focusedRow=e,void 0!==t&&(this.focusedColumn=Math.min(this.columnCount,t)),(this.focusedRow>=this.rowCount||this.getIndex()>=this.emojiCount)&&(this.focusedRow=this.rowCount-1,this.focusedColumn=this.emojiCount%this.columnCount-1),this.events.emit("focus:change",{from:i,to:this.getIndex(),performFocus:o})}setFocusedIndex(e,t=!0){const o=Math.floor(e/this.columnCount),i=e%this.columnCount;this.setCell(o,i,t)}focusNext(){this.focusedColumn<this.columnCount-1&&this.getIndex()<this.emojiCount-1?this.setCell(this.focusedRow,this.focusedColumn+1):this.focusedRow<this.rowCount-1?this.setCell(this.focusedRow+1,0):this.wrap?this.setCell(0,0):this.events.emit("focus:overflow",0)}focusPrevious(){this.focusedColumn>0?this.setCell(this.focusedRow,this.focusedColumn-1):this.focusedRow>0?this.setCell(this.focusedRow-1,this.columnCount-1):this.wrap?this.setCell(this.rowCount-1,this.columnCount-1):this.events.emit("focus:underflow",this.columnCount-1)}focusUp(){this.focusedRow>0?this.setCell(this.focusedRow-1,this.focusedColumn):this.events.emit("focus:underflow",this.focusedColumn)}focusDown(){this.focusedRow<this.rowCount-1?this.setCell(this.focusedRow+1,this.focusedColumn):this.events.emit("focus:overflow",this.focusedColumn)}focusToIndex(e){this.setCell(Math.floor(e/this.columnCount),e%this.columnCount)}getIndex(){return this.focusedRow*this.columnCount+this.focusedColumn}getCell(){return{row:this.focusedRow,column:this.focusedColumn}}getRowCount(){return this.rowCount}}const vo=new Mt((({classes:e})=>`\n  <div class="${e.emojiContainer}">\n    <div data-placeholder="emojis"></div>\n  </div>\n`)),yo=tt("emojiContainer");class wo extends _t{constructor({emojis:e,showVariants:t,preview:o=!0,lazyLoader:i,category:s,fullHeight:n=!1}){super({template:vo,classes:yo}),this.fullHeight=!1,this.showVariants=t,this.lazyLoader=i,this.preview=o,this.emojis=e,this.category=s,this.fullHeight=n,this.setFocus=this.setFocus.bind(this),this.triggerNextCategory=this.triggerNextCategory.bind(this),this.triggerPreviousCategory=this.triggerPreviousCategory.bind(this)}initialize(){this.grid=new fo(this.options.emojisPerRow,this.emojiCount,0,0,!this.category),this.grid.on("focus:change",this.setFocus),this.grid.on("focus:overflow",this.triggerNextCategory),this.grid.on("focus:underflow",this.triggerPreviousCategory),this.uiEvents=[_t.uiEvent("click",this.selectEmoji),_t.uiEvent("keydown",this.grid.handleKeyDown)],this.preview&&this.uiEvents.push(_t.uiEvent("mouseover",this.showPreview),_t.uiEvent("mouseout",this.hidePreview),_t.uiEvent("focus",this.showPreview,{capture:!0}),_t.uiEvent("blur",this.hidePreview,{capture:!0})),super.initialize()}setFocusedView(e,t){if(e)if("string"==typeof e){const t=this.emojis.findIndex((t=>t.emoji===e));this.grid.setFocusedIndex(t,!1),setTimeout((()=>{var e,o,i,s;const n=this.emojiViews[t].el;n.scrollIntoView();const r=null==(e=n.parentElement)?void 0:e.previousElementSibling;(null==(i=null==(o=n.parentElement)?void 0:o.parentElement)?void 0:i.parentElement).scrollTop-=null!=(s=null==r?void 0:r.offsetHeight)?s:0}))}else"first"===e.row||0===e.row?this.grid.setCell(0,e.offset,t):"last"===e.row&&this.grid.setCell(this.grid.getRowCount()-1,e.offset,t)}setActive(e,t,o){var i;e?this.setFocusedView(t,o):null==(i=this.emojiViews[this.grid.getIndex()])||i.deactivateFocus()}renderSync(){return this.emojiViews=this.emojis.map((e=>this.viewFactory.create(go,{emoji:e,category:this.category,lazyLoader:this.lazyLoader,renderer:this.renderer}))),this.emojiElements=this.emojiViews.map((e=>e.renderSync())),super.renderSync({emojis:this.emojiElements,i18n:this.i18n})}destroy(){super.destroy(),this.emojiViews.forEach((e=>e.destroy())),this.grid.destroy()}triggerPreviousCategory(e){this.events.emit("category:previous",e)}triggerNextCategory(e){this.category&&this.events.emit("category:next",e)}setFocus({from:e,to:t,performFocus:o}){var i,s;null==(i=this.emojiViews[e])||i.deactivateFocus(),null==(s=this.emojiViews[t])||s.activateFocus(o)}selectEmoji(e){e.stopPropagation();const t=Xe(e,this.emojis);t&&this.events.emit("emoji:select",{emoji:t,showVariants:this.showVariants})}showPreview(e){const t=e.target.closest("button"),o=null==t?void 0:t.firstElementChild,i=Xe(e,this.emojis);i&&this.events.emit("preview:show",i,null==o?void 0:o.cloneNode(!0))}hidePreview(e){Xe(e,this.emojis)&&this.events.emit("preview:hide")}get emojiCount(){return this.emojis.length}}const bo=new Mt((({classes:e,category:t,pickerId:o,icon:i,i18n:s})=>`\n  <section class="${e.emojiCategory}" role="tabpanel" aria-labelledby="${o}-category-${t.key}">\n    <h3 data-category="${t.key}" class="${e.categoryName}">\n      <i data-icon="${i}"></i>\n      ${s.get(`categories.${t.key}`,t.message||t.key)}\n    </h3>\n    <div data-view="emojis" data-render="sync"></div>\n  </section>\n`));class ko extends uo{constructor({category:e,showVariants:t,lazyLoader:o,emojiVersion:i}){super({category:e,showVariants:t,lazyLoader:o,template:bo}),this.showVariants=t,this.lazyLoader=o,this.emojiVersion=i}initialize(){this.uiElements={...this.baseUIElements},super.initialize()}async render(){await this.emojiDataPromise;const e=await this.emojiData.getEmojis(this.category,this.emojiVersion);return this.emojiContainer=this.viewFactory.create(wo,{emojis:e,showVariants:this.showVariants,lazyLoader:this.lazyLoader,category:this.category.key}),super.render({category:this.category,emojis:this.emojiContainer,emojiCount:e.length,icon:Et[this.category.key]})}}class jo extends wo{constructor({category:e,emojis:t,preview:o=!0,lazyLoader:i}){super({category:e,emojis:t,showVariants:!1,preview:o,lazyLoader:i})}async addOrUpdate(e){const t=this.el.querySelector(`[data-emoji="${e.emoji}"]`);t&&(this.el.removeChild(t),this.emojis=this.emojis.filter((t=>t!==e)));const o=this.viewFactory.create(go,{emoji:e});if(this.el.insertBefore(o.renderSync(),this.el.firstChild),this.emojis=[e,...this.emojis.filter((t=>t!==e))],this.emojis.length>this.options.maxRecents){this.emojis=this.emojis.slice(0,this.options.maxRecents);const e=this.el.childElementCount-this.options.maxRecents;for(let t=0;t<e;t++)this.el.lastElementChild&&this.el.removeChild(this.el.lastElementChild)}}}const Co=new Mt((({emojiCount:e,classes:t,category:o,pickerId:i,icon:s,i18n:n})=>`\n  <section class="${t.emojiCategory}" role="tabpanel" aria-labelledby="${i}-category-${o.key}">\n    <h3 data-category="${o.key}" class="${t.categoryName}">\n      <i data-icon="${s}"></i>\n      ${n.get(`categories.${o.key}`,o.message||o.key)}\n    </h3>\n    <div data-empty="${0===e}" class="${t.recentEmojis}">\n      <div data-view="emojis" data-render="sync"></div>\n    </div>\n    <div class="${t.noRecents}">\n      ${n.get("recents.none")}\n    </div>\n  </section>\n`),{mode:"async"});const _o=new Mt((({classes:e,category:t,pickerId:o,icon:i,i18n:s})=>`\n  <section class="${e.emojiCategory}" role="tabpanel" aria-labelledby="${o}-category-${t.key}">\n    <h3 data-category="${t.key}" class="${e.categoryName}">\n      <i data-icon="${i}"></i>\n      ${s.get(`categories.${t.key}`,t.message||t.key)}\n    </h3>\n    <div data-view="emojis" data-render="sync"></div>\n  </section>\n`));class xo{constructor(){this.elements=new Map}lazyLoad(e,t){return this.elements.set(e,t),e}observe(e){if(window.IntersectionObserver){const t=new IntersectionObserver((e=>{e.filter((e=>e.intersectionRatio>0)).map((e=>e.target)).forEach((e=>{const o=this.elements.get(e);null==o||o(),t.unobserve(e)}))}),{root:e});this.elements.forEach(((e,o)=>{t.observe(o)}))}else this.elements.forEach((e=>{e()}))}}const Eo=tt("emojiArea"),So=new Mt((({classes:e})=>`\n  <div class="${e.emojiArea}">\n    <div data-placeholder="emojis"></div>\n  </div>\n`),{mode:"async"}),Lo={recents:class extends uo{constructor({category:e,lazyLoader:t,provider:o}){super({category:e,showVariants:!1,lazyLoader:t,template:Co}),this.provider=o}initialize(){this.uiElements={...this.baseUIElements,recents:_t.byClass(ho.recentEmojis)},this.appEvents={"recent:add":this.addRecent},super.initialize()}async addRecent(e){await this.emojiContainer.addOrUpdate(e),this.ui.recents.dataset.empty="false"}async render(){var e;const t=null==(e=this.provider)?void 0:e.getRecents(this.options.maxRecents);return this.emojiContainer=this.viewFactory.create(jo,{emojis:t,showVariants:!1,lazyLoader:this.lazyLoader,category:this.category.key}),await super.render({category:this.category,emojis:this.emojiContainer,emojiCount:t.length,icon:Et[this.category.key]}),this.el}},custom:class extends uo{constructor({category:e,lazyLoader:t}){super({template:_o,showVariants:!1,lazyLoader:t,category:e})}initialize(){this.uiElements={...this.baseUIElements},super.initialize()}async render(){return this.emojiContainer=this.viewFactory.create(wo,{emojis:this.customEmojis,showVariants:this.showVariants,lazyLoader:this.lazyLoader,category:this.category.key}),super.render({category:this.category,emojis:this.emojiContainer,emojiCount:this.customEmojis.length,icon:Et[this.category.key]})}}};class $o extends _t{constructor({categoryTabs:e,categories:t,emojiVersion:o}){super({template:So,classes:Eo}),this.selectedCategory=0,this.scrollListenerState="active",this.lazyLoader=new xo,this.categoryTabs=e,this.categories=t,this.emojiVersion=o,this.handleScroll=function(e,t){let o=null;return()=>{o||(o=window.setTimeout((()=>{e(),o=null}),t))}}(this.handleScroll.bind(this),100)}initialize(){this.appEvents={"category:select":this.handleCategorySelect,"category:previous":this.focusPreviousCategory,"category:next":this.focusNextCategory,"focus:change":this.updateFocusedCategory},this.uiElements={emojis:_t.byClass(Eo.emojiArea)},this.uiEvents=[_t.uiEvent("scroll",this.handleScroll)],super.initialize()}get focusableEmoji(){return this.el.querySelector('[tabindex="0"]')}async render(){this.emojiCategories=this.categories.map(this.createCategory,this);const e={};return this.categories.forEach(((t,o)=>{e[`emojis-${t.key}`]=this.emojiCategories[o]})),await super.render({emojis:await Promise.all(this.emojiCategories.map((e=>e.render())))}),this.lazyLoader.observe(this.el),this.el}destroy(){super.destroy(),this.emojiCategories.forEach((e=>{var t;null==(t=this.observer)||t.unobserve(e.el),e.destroy()}))}handleCategorySelect(e,t){this.el.style.overflow="hidden",this.selectCategory(e,t),this.el.style.overflow="auto"}createCategory(e){const t=Lo[e.key]||ko;return this.viewFactory.create(t,{category:e,showVariants:!0,lazyLoader:this.lazyLoader,emojiVersion:this.emojiVersion,provider:this.options.recentsProvider})}determineInitialCategory(){var e;return this.options.initialCategory&&this.categories.find((e=>e.key===this.options.initialCategory))?this.options.initialCategory:null==(e=this.categories.find((e=>"recents"!==e.key)))?void 0:e.key}determineFocusTarget(e){const t=this.emojiCategories.find((t=>t.category.key===e));return this.options.initialEmoji&&(null==t?void 0:t.el.querySelector(`[data-emoji="${this.options.initialEmoji}"]`))?this.options.initialEmoji:"button"}reset(e=!0){this.events.emit("preview:hide");const t=this.determineInitialCategory();t&&(this.selectCategory(t,{focus:this.determineFocusTarget(t),performFocus:e,scroll:"jump"}),this.selectedCategory=this.getCategoryIndex(t))}getCategoryIndex(e){return this.categories.findIndex((t=>t.key===e))}focusPreviousCategory(e){this.selectedCategory>0&&this.focusCategory(this.selectedCategory-1,{row:"last",offset:null!=e?e:this.options.emojisPerRow})}focusNextCategory(e){this.selectedCategory<this.categories.length-1&&this.focusCategory(this.selectedCategory+1,{row:"first",offset:null!=e?e:0})}focusCategory(e,t){this.selectCategory(e,{focus:t,performFocus:!0})}async selectCategory(e,t={}){var o;this.scrollListenerState="suspend";const{focus:i,performFocus:s,scroll:n}={performFocus:!1,...t};this.emojiCategories[this.selectedCategory].setActive(!1);const r=this.selectedCategory="number"==typeof e?e:this.getCategoryIndex(e);null==(o=this.categoryTabs)||o.setActiveTab(this.selectedCategory,{performFocus:s,scroll:"button"===i});const a=this.emojiCategories[r].el.offsetTop;var c;this.emojiCategories[r].setActive(!0,(c=i)&&"button"!==c?c:{row:"first",offset:0},"button"!==i&&s),n&&(this.el.scrollTop=a),this.scrollListenerState="resume"}updateFocusedCategory(e){var t;this.categories[this.selectedCategory].key!==e&&(this.scrollListenerState="suspend",this.selectedCategory=this.getCategoryIndex(e),null==(t=this.categoryTabs)||t.setActiveTab(this.selectedCategory,{changeFocusable:!1,performFocus:!1}),this.scrollListenerState="resume")}handleScroll(){if("suspend"===this.scrollListenerState||!this.categoryTabs)return;if("resume"===this.scrollListenerState)return void(this.scrollListenerState="active");const e=this.el.scrollTop,t=this.el.scrollHeight-this.el.offsetHeight,o=this.emojiCategories.findIndex(((t,o)=>{var i;return e<(null==(i=this.emojiCategories[o+1])?void 0:i.el.offsetTop)})),i={changeFocusable:!1,performFocus:!1,scroll:!1};0===e?this.categoryTabs.setActiveTab(0,i):Math.floor(e)===Math.floor(t)||o<0?this.categoryTabs.setActiveTab(this.categories.length-1,i):this.categoryTabs.setActiveTab(o,i)}}const zo=new Mt((({classList:e,classes:t,icon:o,message:i})=>`\n<div class="${e}" role="alert">\n  <div class="${t.iconContainer}"><i data-size="10x" data-icon="${o}"></i></div>\n  <h3 class="${t.title}">${i}</h3>\n</div>\n`)),Po=tt("error","iconContainer","title");class To extends _t{constructor({message:e,icon:t="warning",template:o=zo,className:i}){super({template:o,classes:Po}),this.message=e,this.icon=t,this.className=i}renderSync(){const e=[Po.error,this.className].join(" ").trim();return super.renderSync({message:this.message,icon:this.icon,classList:e})}}const Io=new Mt((({classList:e,classes:t,icon:o,i18n:i,message:s})=>`\n  <div class="${e}" role="alert">\n    <div class="${t.icon}"><i data-size="10x" data-icon="${o}"></i></div>\n    <h3 class="${t.title}">${s}</h3>\n    <button type="button">${i.get("retry")}</button>\n  </div>\n`)),Fo=tt("dataError");class Bo extends To{constructor({message:e}){super({message:e,template:Io,className:Fo.dataError})}initialize(){this.uiElements={retryButton:"button"},this.uiEvents=[_t.childEvent("retryButton","click",this.onRetry)],super.initialize()}async onRetry(){this.emojiData?await this.emojiData.delete():await this.options.dataStore.deleteDatabase(this.options.locale),this.events.emit("reinitialize");const e=await wt(this.options.locale,this.options.dataStore,this.options.messages,this.options.emojiData,this.emojiData);this.viewFactory.setEmojiData(e),this.events.emit("data:ready",e)}}const Ao=tt("preview","previewEmoji","previewName","tagList","tag"),Mo=new Mt((({classes:e,tag:t})=>`\n  <li class="${e.tag}">${t}</li>\n`)),Ro=new Mt((({classes:e})=>`\n  <div class="${e.preview}">\n    <div class="${e.previewEmoji}"></div>\n    <div class="${e.previewName}"></div>\n    <ul class="${e.tagList}"></ul>\n  </div>\n`));class No extends _t{constructor(){super({template:Ro,classes:Ao})}initialize(){this.uiElements={emoji:_t.byClass(Ao.previewEmoji),name:_t.byClass(Ao.previewName),tagList:_t.byClass(Ao.tagList)},this.appEvents={"preview:show":this.showPreview,"preview:hide":this.hidePreview},super.initialize()}showPreview(e,t){if(st(this.ui.emoji,t),this.ui.name.textContent=e.label,e.tags){this.ui.tagList.style.display="flex";const t=e.tags.map((e=>Mo.renderSync({tag:e,classes:Ao})));st(this.ui.tagList,...t)}}hidePreview(){it(this.ui.emoji),it(this.ui.name),it(this.ui.tagList)}}const Oo=new Mt((({classes:e,i18n:t})=>`\n  <button title="${t.get("search.clear")}" class="${e.clearSearchButton}">\n    <i data-icon="xmark"></i>\n  </button>\n`)),Vo=new Mt((({classes:e,i18n:t})=>`\n<div class="${e.searchContainer}">\n  <input class="${e.searchField}" placeholder="${t.get("search")}">\n  <span class="${e.searchAccessory}"></span>\n</div>\n`),{mode:"async"}),Do=tt("searchContainer","searchField","clearButton","searchAccessory","clearSearchButton","notFound");class Ho extends _t{constructor({categories:e,emojiVersion:t}){super({template:Vo,classes:Do}),this.categories=e.filter((e=>"recents"!==e.key)),this.emojiVersion=t,this.search=function(e,t){let o=null;return(...i)=>{o&&window.clearTimeout(o),o=window.setTimeout((()=>{e(...i),o=null}),t)}}(this.search.bind(this),100)}initialize(){this.uiElements={searchField:_t.byClass(Do.searchField),searchAccessory:_t.byClass(Do.searchAccessory)},this.uiEvents=[_t.childEvent("searchField","keydown",this.onKeyDown),_t.childEvent("searchField","input",this.onSearchInput)],super.initialize()}async render(){return await super.render(),this.searchIcon=St("search"),this.notFoundMessage=this.viewFactory.create(To,{message:this.i18n.get("search.notFound"),className:Do.notFound,icon:"sad"}),this.notFoundMessage.renderSync(),this.errorMessage=this.viewFactory.create(To,{message:this.i18n.get("search.error")}),this.errorMessage.renderSync(),this.clearSearchButton=Oo.render({classes:Do,i18n:this.i18n}),this.clearSearchButton.addEventListener("click",(e=>this.onClearSearch(e))),this.searchField=this.ui.searchField,this.showSearchIcon(),this.el}showSearchIcon(){this.showSearchAccessory(this.searchIcon)}showClearSearchButton(){this.showSearchAccessory(this.clearSearchButton)}showSearchAccessory(e){st(this.ui.searchAccessory,e)}clear(){this.searchField.value="",this.showSearchIcon()}focus(){this.searchField.focus()}onClearSearch(e){var t;e.stopPropagation(),this.searchField.value="",null==(t=this.resultsContainer)||t.destroy(),this.resultsContainer=null,this.showSearchIcon(),this.events.emit("content:show"),this.searchField.focus()}handleResultsKeydown(e){this.resultsContainer&&"Escape"===e.key&&this.onClearSearch(e)}onKeyDown(e){var t;"Escape"===e.key&&this.searchField.value?this.onClearSearch(e):("Enter"===e.key||"ArrowDown"===e.key)&&this.resultsContainer&&(e.preventDefault(),null==(t=this.resultsContainer.el.querySelector('[tabindex="0"]'))||t.focus())}onSearchInput(e){this.searchField.value?(this.showClearSearchButton(),this.search()):this.onClearSearch(e)}async search(){var e;if(this.searchField.value)try{const t=await this.emojiData.searchEmojis(this.searchField.value,this.customEmojis,this.emojiVersion,this.categories);if(this.events.emit("preview:hide"),t.length){const o=new xo;this.resultsContainer=this.viewFactory.create(wo,{emojis:t,fullHeight:!0,showVariants:!0,lazyLoader:o}),this.resultsContainer.renderSync(),null!=(e=this.resultsContainer)&&e.el&&(o.observe(this.resultsContainer.el),this.resultsContainer.setActive(!0,{row:0,offset:0},!1),this.resultsContainer.el.addEventListener("keydown",(e=>this.handleResultsKeydown(e))),this.events.emit("content:show",this.resultsContainer))}else this.events.emit("content:show",this.notFoundMessage)}catch{this.events.emit("content:show",this.errorMessage)}}}const Uo=new Mt((({classes:e})=>`\n  <div class="${e.variantOverlay}">\n    <div class="${e.variantPopup}">\n      <div data-view="emojis" data-render="sync"></div>\n    </div>\n  </div>\n`)),Wo=tt("variantOverlay","variantPopup"),qo={easing:"ease-in-out",duration:250,fill:"both"},Ko={opacity:[0,1]},Go={opacity:[0,1],transform:["scale3d(0.8, 0.8, 0.8)","scale3d(1, 1, 1)"]};class Jo extends _t{constructor({emoji:e,parent:t}){super({template:Uo,classes:Wo,parent:t}),this.focusedEmojiIndex=0,this.focusTrap=new bt,this.animateShow=()=>Promise.all([Ze(this.el,Ko,qo,this.options),Ze(this.ui.popup,Go,qo,this.options)]),this.emoji=e}initialize(){this.uiElements={popup:_t.byClass(Wo.variantPopup)},this.uiEvents=[_t.uiEvent("click",this.handleClick),_t.uiEvent("keydown",this.handleKeydown)],super.initialize()}animateHide(){const e={...qo,direction:"reverse"};return Promise.all([Ze(this.el,Ko,e,this.options),Ze(this.ui.popup,Go,e,this.options)])}async hide(){await this.animateHide(),this.events.emit("variantPopup:hide")}handleKeydown(e){"Escape"===e.key&&(this.hide(),e.stopPropagation())}handleClick(e){this.ui.popup.contains(e.target)||this.hide()}getEmoji(e){return this.renderedEmojis[e]}setFocusedEmoji(e){this.getEmoji(this.focusedEmojiIndex).tabIndex=-1,this.focusedEmojiIndex=e;const t=this.getEmoji(this.focusedEmojiIndex);t.tabIndex=0,t.focus()}destroy(){this.emojiContainer.destroy(),this.focusTrap.deactivate(),super.destroy()}renderSync(){const e=[{...this.emoji,skins:null},...(this.emoji.skins||[]).map((e=>({...e,label:this.emoji.label,tags:this.emoji.tags})))];return this.emojiContainer=this.viewFactory.create(wo,{emojis:e,preview:!1}),super.renderSync({emojis:this.emojiContainer}),e.length<this.options.emojisPerRow&&this.el.style.setProperty("--emojis-per-row",e.length.toString()),this.el}activate(){this.emojiContainer.setActive(!0,{row:0,offset:0},!0),this.focusTrap.activate(this.el)}}const Xo=new Mt((({classes:e,i18n:t,category:o,pickerId:i,icon:s})=>`\n<li class="${e.categoryTab}">\n  <button\n    aria-selected="false"\n    role="tab"\n    class="${e.categoryButton}"\n    tabindex="-1"\n    title="${t.get(`categories.${o.key}`,o.message||o.key)}"\n    type="button"\n    data-category="${o.key}"\n    id="${i}-category-${o.key}"\n  >\n    <i data-icon="${s}"></i>\n</li>\n`)),Yo=tt("categoryTab","categoryTabActive","categoryButton");class Qo extends _t{constructor({category:e,icon:t}){super({template:Xo,classes:Yo}),this.isActive=!1,this.category=e,this.icon=t}initialize(){this.uiElements={button:_t.byClass(Yo.categoryButton)},this.uiEvents=[_t.childEvent("button","click",this.selectCategory),_t.childEvent("button","focus",this.selectCategory)],super.initialize()}renderSync(){return super.renderSync({category:this.category,icon:this.icon}),this.ui.button.ariaSelected="false",this.el}setActive(e,t={}){const{changeFocusable:o,performFocus:i,scroll:s}={changeFocusable:!0,performFocus:!0,scroll:!0,...t};this.el.classList.toggle(Yo.categoryTabActive,e),o&&(this.ui.button.tabIndex=e?0:-1,this.ui.button.ariaSelected=e.toString()),e&&i&&(this.ui.button.focus(),s&&this.events.emit("category:select",this.category.key,{scroll:"animate",focus:"button",performFocus:!1})),this.isActive=e}selectCategory(){this.isActive||this.events.emit("category:select",this.category.key,{scroll:"animate",focus:"button",performFocus:!0})}}const Zo=new Mt((({classes:e})=>`\n  <div class="${e.categoryButtonsContainer}">\n    <ul role="tablist" class="${e.categoryButtons}">\n      <div data-placeholder="tabs"></div>\n    </ul>\n  </div>\n`)),ei=tt("categoryButtons","categoryButtonsContainer");class ti extends _t{constructor({categories:e}){super({template:Zo,classes:ei}),this.activeCategoryIndex=0,this.categories=e}initialize(){this.keyBindings={ArrowLeft:this.stepSelectedTab(-1),ArrowRight:this.stepSelectedTab(1)},this.uiEvents=[_t.uiEvent("scroll",this.checkOverflow)],super.initialize()}checkOverflow(){const e=Math.abs(this.el.scrollLeft-(this.el.scrollWidth-this.el.offsetWidth))>1,t=this.el.scrollLeft>0;this.el.className="categoryButtonsContainer",t&&e?this.el.classList.add("has-overflow-both"):t?this.el.classList.add("has-overflow-left"):e&&this.el.classList.add("has-overflow-right")}renderSync(){return this.tabViews=this.categories.map((e=>this.viewFactory.create(Qo,{category:e,icon:Et[e.key]}))),super.renderSync({tabs:this.tabViews.map((e=>e.renderSync()))}),this.el}get currentCategory(){return this.categories[this.activeCategoryIndex]}get currentTabView(){return this.tabViews[this.activeCategoryIndex]}setActiveTab(e,t={}){this.checkOverflow();const o=this.currentTabView,i=this.tabViews[e];o.setActive(!1,t),i.setActive(!0,t),this.activeCategoryIndex=e}getTargetCategory(e){return e<0?this.categories.length-1:e>=this.categories.length?0:e}stepSelectedTab(e){return()=>{const t=this.activeCategoryIndex+e;this.setActiveTab(this.getTargetCategory(t),{changeFocusable:!0,performFocus:!0})}}}const oi=[{version:15,emoji:String.fromCodePoint(129768)},{version:14,emoji:String.fromCodePoint(128733)},{version:13,emoji:String.fromCodePoint(129729)},{version:12,emoji:String.fromCodePoint(129449)},{version:11,emoji:String.fromCodePoint(129463)},{version:5,emoji:String.fromCodePoint(129322)},{version:4,emoji:String.fromCodePoint(9877)},{version:3,emoji:String.fromCodePoint(129314)},{version:2,emoji:String.fromCodePoint(128488)},{version:1,emoji:String.fromCodePoint(128512)}];function ii(){var e;const t=oi.find((e=>function(e){const t=document.createElement("canvas").getContext("2d");if(t)return t.textBaseline="top",t.font="32px Arial",t.fillText(e,0,0),0!==t.getImageData(16,16,1,1).data[0]}(e.emoji)));return null!=(e=null==t?void 0:t.version)?e:1}function si(e,t){return Array.from({length:e},(()=>t)).join("")}function ni(e){const{emojiCount:t,classes:o,theme:i,className:s,categoryCount:n}=e;return`\n    <div class="picmo__picker ${o.skeleton} ${o.picker} ${i} ${s}">\n      ${(({showHeader:t,classes:o})=>t?`\n    <header class="${o.headerSkeleton}">\n      ${(({showSearch:e,classes:t})=>e?`\n    <div class="${t.searchSkeleton}">\n      <div class="${t.searchInput} ${t.placeholder}"></div>\n    </div>\n  `:"")(e)}\n      ${(({showCategoryTabs:e,classes:t})=>e?`\n    <div class="${t.categoryTabsSkeleton}">\n      ${si(n,`<div class="${t.placeholder} ${t.categoryTab}"></div>`)}\n    </div>\n  `:"")(e)}\n    </header>\n  `:"")(e)}\n      <div class="${o.contentSkeleton}">\n        <div class="${o.placeholder} ${o.categoryName}"></div>\n        <div class="${o.emojiGrid}">\n          ${si(t,`<div class="${o.placeholder} ${o.emoji}"></div>`)}\n        </div>\n      </div>\n      ${(({showPreview:e,classes:t})=>e?`\n    <div class="${t.previewSkeleton}">\n      <div class="${t.placeholder} ${t.previewEmoji}"></div>\n      <div class="${t.placeholder} ${t.previewName}"></div>\n      <ul class="${t.tagList}">\n        ${si(3,`<li class="${t.placeholder} ${t.tag}"></li>`)}\n      </ul>\n    </div>\n  `:"")(e)}\n    </div>\n  `}const ri=new Mt((e=>e.isLoaded?function(e){const{classes:t,theme:o,className:i=""}=e;return`\n    <div class="picmo__picker ${t.picker} ${o} ${i}">\n      ${function({showHeader:e,classes:t}){return e?`\n    <header class="${t.header}">\n      <div data-view="search"></div>\n      <div data-view="categoryTabs" data-render="sync"></div>\n    </header>\n  `:""}(e)}\n      <div class="${t.content}">\n        <div data-view="emojiArea"></div>\n      </div>\n      <div data-view="preview"></div>\n    </div>\n  `}(e):ni(e))),ai=tt("picker","skeleton","placeholder","searchSkeleton","searchInput","categoryTabsSkeleton","headerSkeleton","categoryTab","contentSkeleton","categoryName","emojiGrid","emoji","previewSkeleton","previewEmoji","previewName","tagList","tag","overlay","content","fullHeight","pluginContainer","header"),ci={emojisPerRow:"--emojis-per-row",visibleRows:"--row-count",emojiSize:"--emoji-size"};class li extends _t{constructor(){super({template:ri,classes:ai}),this.pickerReady=!1,this.externalEvents=new lo,this.updaters={styleProperty:e=>t=>this.el.style.setProperty(ci[e],t.toString()),theme:e=>{const t=this.options.theme,o=this.el.closest(`.${t}`);this.el.classList.remove(t),null==o||o.classList.remove(t),this.el.classList.add(e),null==o||o.classList.add(e)},className:e=>{this.options.className&&this.el.classList.remove(this.options.className),this.el.classList.add(e)},emojisPerRow:this.updateStyleProperty.bind(this,"emojisPerRow"),emojiSize:this.updateStyleProperty.bind(this,"emojiSize"),visibleRows:this.updateStyleProperty.bind(this,"visibleRows")}}initialize(){this.uiElements={pickerContent:_t.byClass(ai.content),header:_t.byClass(ai.header)},this.uiEvents=[_t.uiEvent("keydown",this.handleKeyDown)],this.appEvents={error:this.onError,reinitialize:this.reinitialize,"data:ready":this.onDataReady,"content:show":this.showContent,"variantPopup:hide":this.hideVariantPopup,"emoji:select":this.selectEmoji},super.initialize(),this.options.recentsProvider}destroy(){var e,t;super.destroy(),null==(e=this.search)||e.destroy(),this.emojiArea.destroy(),null==(t=this.categoryTabs)||t.destroy(),this.events.removeAll(),this.externalEvents.removeAll()}clearRecents(){this.options.recentsProvider.clear()}addEventListener(e,t){this.externalEvents.on(e,t)}removeEventListener(e,t){this.externalEvents.off(e,t)}initializePickerView(){this.pickerReady&&(this.showContent(),this.emojiArea.reset(!1))}handleKeyDown(e){const t=e.ctrlKey||e.metaKey;"s"===e.key&&t&&this.search&&(e.preventDefault(),this.search.focus())}buildChildViews(){return this.options.showPreview&&(this.preview=this.viewFactory.create(No)),this.options.showSearch&&(this.search=this.viewFactory.create(Ho,{categories:this.categories,emojiVersion:this.emojiVersion})),this.options.showCategoryTabs&&(this.categoryTabs=this.viewFactory.create(ti,{categories:this.categories})),this.currentView=this.emojiArea=this.viewFactory.create($o,{categoryTabs:this.categoryTabs,categories:this.categories,emojiVersion:this.emojiVersion}),[this.preview,this.search,this.emojiArea,this.categoryTabs]}setStyleProperties(){this.options.showSearch||this.el.style.setProperty("--search-height-full","0px"),this.options.showCategoryTabs||(this.el.style.setProperty("--category-tabs-height","0px"),this.el.style.setProperty("--category-tabs-offset","0px")),this.options.showPreview||this.el.style.setProperty("--emoji-preview-height-full","0px"),Object.keys(ci).forEach((e=>{this.options[e]&&this.el.style.setProperty(ci[e],this.options[e].toString())}))}updateStyleProperty(e,t){this.el.style.setProperty(ci[e],t.toString())}reinitialize(){this.renderSync()}onError(e){const t=this.viewFactory.createWithOptions({data:!1},Bo,{message:this.i18n.get("error.load")}),o=this.el.offsetHeight||375;throw this.el.style.height=`${o}px`,st(this.el,t.renderSync()),e}async onDataReady(e){const t=this.el;try{e?this.emojiData=e:await this.emojiDataPromise,"auto"===this.options.emojiVersion?this.emojiVersion=ii()||parseFloat("14.0"):this.emojiVersion=this.options.emojiVersion,this.categories=await this.emojiData.getCategories(this.options);const[o,i,s,n]=this.buildChildViews();await super.render({isLoaded:!0,search:i,categoryTabs:n,emojiArea:s,preview:o,showHeader:Boolean(this.search||this.categoryTabs),theme:this.options.theme,className:this.options.className}),this.el.style.setProperty("--category-count",this.categories.length.toString()),this.pickerReady=!0,t.replaceWith(this.el),this.setStyleProperties(),this.initializePickerView(),this.setInitialFocus(),this.externalEvents.emit("data:ready")}catch(e){this.events.emit("error",e)}}renderSync(){var e;let t=(null==(e=this.options.categories)?void 0:e.length)||10;if(this.options.showRecents&&(t+=1),super.renderSync({isLoaded:!1,theme:this.options.theme,className:this.options.className,showSearch:this.options.showSearch,showPreview:this.options.showPreview,showCategoryTabs:this.options.showCategoryTabs,showHeader:this.options.showSearch||this.options.showCategoryTabs,emojiCount:this.options.emojisPerRow*this.options.visibleRows,categoryCount:t}),this.el.style.setProperty("--category-count",t.toString()),!this.options.rootElement)throw new Error("Picker must be given a root element via the rootElement option");return st(this.options.rootElement,this.el),this.setStyleProperties(),this.pickerReady&&this.initializePickerView(),this.el}getInitialFocusTarget(){if(typeof this.options.autoFocus<"u")switch(this.options.autoFocus){case"emojis":return this.emojiArea.focusableEmoji;case"search":return this.search;case"auto":return this.search||this.emojiArea.focusableEmoji;default:return null}if(!0===this.options.autoFocusSearch)return console.warn("options.autoFocusSearch is deprecated, please use options.focusTarget instead"),this.search}setInitialFocus(){var e;!this.pickerReady||null==(e=this.getInitialFocusTarget())||e.focus()}reset(e=!0){var t;this.pickerReady&&(this.emojiArea.reset(e),this.showContent(this.emojiArea)),null==(t=this.search)||t.clear(),this.hideVariantPopup()}showContent(e=this.emojiArea){var t,o;e!==this.currentView&&(this.currentView!==this.emojiArea&&(null==(t=this.currentView)||t.destroy()),this.ui.pickerContent.classList.toggle(ai.fullHeight,e!==this.emojiArea),st(this.ui.pickerContent,e.el),this.currentView=e,e===this.emojiArea?(this.emojiArea.reset(),this.categoryTabs&&this.ui.header.appendChild(this.categoryTabs.el)):null==(o=this.categoryTabs)||o.el.remove())}hideVariantPopup(){var e;null==(e=this.variantPopup)||e.destroy()}isPickerClick(e){var t,o;const i=e.target,s=this.el.contains(i),n=null==(o=null==(t=this.variantPopup)?void 0:t.el)?void 0:o.contains(i);return s||n}async selectEmoji({emoji:e}){var t,o;(null==(t=e.skins)?void 0:t.length)&&this.options.showVariants&&!this.isVariantPopupOpen?this.showVariantPopup(e):(await(null==(o=this.variantPopup)?void 0:o.animateHide()),this.events.emit("variantPopup:hide"),await this.emitEmoji(e))}get isVariantPopupOpen(){return this.variantPopup&&!this.variantPopup.isDestroyed}async showVariantPopup(e){const t=document.activeElement;this.events.once("variantPopup:hide",(()=>{null==t||t.focus()})),this.variantPopup=this.viewFactory.create(Jo,{emoji:e,parent:this.el}),this.el.appendChild(this.variantPopup.renderSync()),this.variantPopup.activate()}async emitEmoji(e){this.externalEvents.emit("emoji:select",await this.renderer.doEmit(e)),this.options.recentsProvider.addOrUpdateRecent(e,this.options.maxRecents),this.events.emit("recent:add",e)}updateOptions(e){Object.keys(e).forEach((t=>{this.updaters[t](e[t])})),Object.assign(this.options,e)}}class di{constructor({events:e,i18n:t,renderer:o,emojiData:i,options:s,customEmojis:n=[],pickerId:r}){this.events=e,this.i18n=t,this.renderer=o,this.emojiData=i,this.options=s,this.customEmojis=n,this.pickerId=r}setEmojiData(e){this.emojiData=Promise.resolve(e)}createWithOptions(e={},t,...o){const i=new t(...o);return i.setPickerId(this.pickerId),i.setEvents(this.events),i.setI18n(this.i18n),i.setRenderer(this.renderer),!1!==e.data&&i.setEmojiData(this.emojiData),i.setOptions(this.options),i.setCustomEmojis(this.customEmojis),i.viewFactory=this,i.initialize(),i}create(e,...t){return this.createWithOptions({},e,...t)}}var hi;class ui{constructor(e={}){Ve(this,hi,void 0),De(this,hi,new Map(Object.entries(e)))}get(e,t=e){return Oe(this,hi).get(e)||t}}hi=new WeakMap;let mi,pi=0;const gi=function(){let e=!1;return function(t){ao&&!e&&(function(e,t){void 0===t&&(t={});var o=t.insertAt;if(e&&!(typeof document>"u")){var i=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css","top"===o&&i.firstChild?i.insertBefore(s,i.firstChild):i.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}}(t),e=!0)}}();function fi(e){gi('.picmo__picker .picmo__icon{width:1.25em;height:1em;fill:currentColor}.picmo__icon-small{font-size:.8em}.picmo__icon-medium{font-size:1em}.picmo__icon-large{font-size:1.25em}.picmo__icon-2x{font-size:2em}.picmo__icon-3x{font-size:3em}.picmo__icon-4x{font-size:4em}.picmo__icon-5x{font-size:5em}.picmo__icon-8x{font-size:8em}.picmo__icon-10x{font-size:10em}.picmo__light,.picmo__auto{color-scheme:light;--accent-color: #4f46e5;--background-color: #f9fafb;--border-color: #cccccc;--category-name-background-color: #f9fafb;--category-name-button-color: #999999;--category-name-text-color: hsl(214, 30%, 50%);--category-tab-active-background-color: rgba(255, 255, 255, .6);--category-tab-active-color: var(--accent-color);--category-tab-color: #666;--category-tab-highlight-background-color: rgba(0, 0, 0, .15);--error-color-dark: hsl(0, 100%, 45%);--error-color: hsl(0, 100%, 40%);--focus-indicator-background-color: hsl(198, 65%, 85%);--focus-indicator-color: #333333;--hover-background-color: #c7d2fe;--placeholder-background-color: #cccccc;--search-background-color: #f9fafb;--search-focus-background-color: #ffffff;--search-icon-color: #999999;--search-placeholder-color: #71717a;--secondary-background-color: #e2e8f0;--secondary-text-color: #666666;--tag-background-color: rgba(162, 190, 245, .3);--text-color: #000000;--variant-popup-background-color: #ffffff}.picmo__dark{color-scheme:dark;--accent-color: #A580F9;--background-color: #333333;--border-color: #666666;--category-name-background-color: #333333;--category-name-button-color: #eeeeee;--category-name-text-color: #ffffff;--category-tab-active-background-color: #000000;--category-tab-active-color: var(--accent-color);--category-tab-color: #cccccc;--category-tab-highlight-background-color: #4A4A4A;--error-color-dark: hsl(0, 7%, 3%);--error-color: hsl(0, 30%, 60%);--focus-indicator-background-color: hsl(0, 0%, 50%);--focus-indicator-color: #999999;--hover-background-color: hsla(0, 0%, 40%, .85);--image-placeholder-color: #ffffff;--placeholder-background-color: #666666;--search-background-color: #71717a;--search-focus-background-color: #52525b;--search-icon-color: #cccccc;--search-placeholder-color: #d4d4d8;--secondary-background-color: #000000;--secondary-text-color: #999999;--tag-background-color: rgba(162, 190, 245, .3);--text-color: #ffffff;--variant-popup-background-color: #333333}@media (prefers-color-scheme: dark){.picmo__auto{color-scheme:dark;--accent-color: #A580F9;--background-color: #333333;--border-color: #666666;--category-name-background-color: #333333;--category-name-button-color: #eeeeee;--category-name-text-color: #ffffff;--category-tab-active-background-color: #000000;--category-tab-active-color: var(--accent-color);--category-tab-color: #cccccc;--category-tab-highlight-background-color: #4A4A4A;--error-color-dark: hsl(0, 7%, 3%);--error-color: hsl(0, 30%, 60%);--focus-indicator-background-color: hsl(0, 0%, 50%);--focus-indicator-color: #999999;--hover-background-color: hsla(0, 0%, 40%, .85);--image-placeholder-color: #ffffff;--placeholder-background-color: #666666;--search-background-color: #71717a;--search-focus-background-color: #52525b;--search-icon-color: #cccccc;--search-placeholder-color: #d4d4d8;--secondary-background-color: #000000;--secondary-text-color: #999999;--tag-background-color: rgba(162, 190, 245, .3);--text-color: #ffffff;--variant-popup-background-color: #333333}}.picmo__picker .picmo__categoryButtonsContainer{overflow:auto;padding:2px 0}.picmo__picker .picmo__categoryButtonsContainer.picmo__has-overflow-right{mask-image:linear-gradient(270deg,rgba(255,255,255,0) 0%,rgba(255,255,255,1) 10%);-webkit-mask-image:linear-gradient(270deg,rgba(255,255,255,0) 0%,rgba(255,255,255,1) 10%)}.picmo__picker .picmo__categoryButtonsContainer.picmo__has-overflow-left{mask-image:linear-gradient(90deg,rgba(255,255,255,0) 0%,rgba(255,255,255,1) 10%);-webkit-mask-image:linear-gradient(90deg,rgba(255,255,255,0) 0%,rgba(255,255,255,1) 10%)}.picmo__picker .picmo__categoryButtonsContainer.picmo__has-overflow-both{mask-image:linear-gradient(90deg,rgba(255,255,255,0) 0%,rgba(255,255,255,1) 10%,rgba(255,255,255,1) 90%,rgba(255,255,255,0) 100%);-webkit-mask-image:linear-gradient(90deg,rgba(255,255,255,0) 0%,rgba(255,255,255,1) 10%,rgba(255,255,255,1) 90%,rgba(255,255,255,0) 100%)}.picmo__picker .picmo__categoryButtons{display:flex;flex-direction:row;gap:var(--tab-gap);margin:0;padding:0 .5em;align-items:center;height:var(--category-tabs-height);box-sizing:border-box;width:100%;justify-content:space-between;position:relative;list-style-type:none;justify-self:center;max-width:min(23.55rem,calc(var(--category-count, 1) * 2.5rem))}.picmo__picker .picmo__categoryButtons .picmo__categoryTab{display:flex;align-items:center;transition:all .1s;width:2em}.picmo__picker .picmo__categoryButtons .picmo__categoryTab.picmo__categoryTabActive .picmo__categoryButton{color:var(--category-tab-active-color);background:linear-gradient(rgba(255,255,255,.75) 0%,rgba(255,255,255,.75) 100%),linear-gradient(var(--category-tab-active-color) 0%,var(--category-tab-active-color) 100%);border:2px solid var(--category-tab-active-color)}.picmo__picker .picmo__categoryButtons .picmo__categoryTab.picmo__categoryTabActive .picmo__categoryButton:hover{background-color:var(--category-tab-active-background-color)}.picmo__picker .picmo__categoryButtons .picmo__categoryTab button.picmo__categoryButton{border-radius:5px;background:transparent;border:2px solid transparent;color:var(--category-tab-color);cursor:pointer;padding:2px;vertical-align:middle;display:flex;align-items:center;justify-content:center;font-size:1.2rem;width:1.6em;height:1.6em;transition:all .1s}.picmo__picker .picmo__categoryButtons .picmo__categoryTab button.picmo__categoryButton:is(img){width:var(--category-tab-size);height:var(--category-tab-size)}.picmo__picker .picmo__categoryButtons .picmo__categoryTab button.picmo__categoryButton:hover{background:var(--category-tab-highlight-background-color)}.picmo__dataError [data-icon]{opacity:.8}@keyframes appear{0%{opacity:0}to{opacity:.8}}@keyframes appear-grow{0%{opacity:0;transform:scale(.8)}to{opacity:.8;transform:scale(1)}}.picmo__picker .picmo__error{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;color:var(--secondary-text-color)}.picmo__picker .picmo__error .picmo__iconContainer{opacity:.8;animation:appear-grow .25s cubic-bezier(.175,.885,.32,1.275);--color-primary: var(--error-color);--color-secondary: var(--error-color-dark)}.picmo__picker .picmo__error .picmo__title{animation:appear .25s;animation-delay:50ms;animation-fill-mode:both}.picmo__picker .picmo__error button{padding:8px 16px;cursor:pointer;background:var(--background-color);border:1px solid var(--text-color);border-radius:5px;color:var(--text-color)}.picmo__picker .picmo__error button:hover{background:var(--text-color);color:var(--background-color)}.picmo__emojiButton{background:transparent;border:none;border-radius:15px;cursor:pointer;display:flex;font-family:var(--emoji-font);font-size:var(--emoji-size);height:100%;justify-content:center;align-items:center;margin:0;overflow:hidden;padding:0;width:100%}.picmo__emojiButton:hover{background:var(--hover-background-color)}.picmo__emojiButton:focus{border-radius:0;background:var(--focus-indicator-background-color);outline:1px solid var(--focus-indicator-color)}.picmo__picker .picmo__emojiArea{height:var(--emoji-area-height);overflow-y:auto;position:relative}.picmo__picker .picmo__emojiCategory{position:relative}.picmo__picker .picmo__emojiCategory .picmo__categoryName{font-size:.9em;padding:.5rem;margin:0;background:var(--category-name-background-color);color:var(--category-name-text-color);top:0;z-index:1;display:grid;gap:4px;grid-template-columns:auto 1fr auto;align-items:center;line-height:1;box-sizing:border-box;height:var(--category-name-height);justify-content:flex-start;text-transform:uppercase}.picmo__picker .picmo__emojiCategory .picmo__categoryName button{background:transparent;border:none;display:flex;align-items:center;cursor:pointer;color:var(--category-name-button-color)}.picmo__picker .picmo__emojiCategory .picmo__categoryName button:hover{opacity:1}.picmo__picker .picmo__emojiCategory .picmo__noRecents{color:var(--secondary-text-color);grid-column:1 / span var(--emojis-per-row);font-size:.9em;text-align:center;display:flex;align-items:center;justify-content:center;min-height:calc(var(--emoji-size) * var(--emoji-size-multiplier))}.picmo__picker .picmo__emojiCategory .picmo__recentEmojis[data-empty=true]{display:none}:is(.picmo__picker .picmo__emojiCategory) .picmo__recentEmojis[data-empty=false]+div{display:none}.picmo__picker .picmo__emojiContainer{display:grid;justify-content:space-between;gap:1px;padding:0 .5em;grid-template-columns:repeat(var(--emojis-per-row),calc(var(--emoji-size) * var(--emoji-size-multiplier)));grid-auto-rows:calc(var(--emoji-size) * var(--emoji-size-multiplier));align-items:center;justify-items:center}.picmo__picker.picmo__picker{--border-radius: 5px;--emoji-area-height: calc( (var(--row-count) * var(--emoji-size) * var(--emoji-size-multiplier)) + var(--category-name-height) );--content-height: var(--emoji-area-height);--emojis-per-row: 8;--row-count: 6;--emoji-preview-margin: 4px;--emoji-preview-height: calc(var(--emoji-preview-size) + 1em + 1px);--emoji-preview-height-full: calc(var(--emoji-preview-height) + var(--emoji-preview-margin));--emoji-preview-size: 2.75em;--emoji-size: 2rem;--emoji-size-multiplier: 1.3;--content-margin: 8px;--category-tabs-height:calc(1.5em + 9px);--category-tabs-offset: 8px;--category-tab-size: 1.2rem;--category-name-height: 2rem;--category-name-padding-y: 6px;--search-height: 2em;--search-margin: .5em;--search-margin-bottom: 4px;--search-height-full: calc(var(--search-height) + var(--search-margin) + var(--search-margin-bottom));--overlay-background-color: rgba(0, 0, 0, .8);--emoji-font: "Segoe UI Emoji", "Segoe UI Symbol", "Segoe UI", "Apple Color Emoji", "Twemoji Mozilla", "Noto Color Emoji", "EmojiOne Color", "Android Emoji";--ui-font: -apple-system, BlinkMacSystemFont, "Helvetica Neue", sans-serif;--ui-font-size: 16px;--picker-width: calc(var(--emojis-per-row) * var(--emoji-size) * var(--emoji-size-multiplier) + 2.75rem);--preview-background-color: var(--secondary-background-color);background:var(--background-color);border-radius:var(--border-radius);border:1px solid var(--border-color);font-family:var(--ui-font);font-size:var(--ui-font-size);overflow:hidden;position:relative;width:var(--picker-width);display:grid;gap:8px}.picmo__picker.picmo__picker>*{font-family:var(--ui-font)}.picmo__picker.picmo__skeleton{background:var(--background-color);border-radius:var(--border-radius);border:1px solid var(--border-color);font-family:var(--ui-font);width:var(--picker-width);color:var(--secondary-text-color)}.picmo__picker.picmo__skeleton *{box-sizing:border-box}.picmo__picker.picmo__skeleton .picmo__placeholder{background:var(--placeholder-background-color);position:relative;overflow:hidden}.picmo__picker.picmo__skeleton .picmo__placeholder:after{position:absolute;top:0;right:0;bottom:0;left:0;transform:translate(-100%);background-image:linear-gradient(90deg,rgba(255,255,255,0) 0,rgba(255,255,255,.2) 20%,rgba(255,255,255,.5) 60%,rgba(255,255,255,0) 100%);animation:shine 2s infinite;content:""}.picmo__picker.picmo__skeleton .picmo__headerSkeleton{background-color:var(--secondary-background-color);padding-top:8px;padding-bottom:8px;display:flex;flex-direction:column;overflow:hidden;gap:8px;border-bottom:1px solid var(--border-color);width:var(--picker-width)}.picmo__picker.picmo__skeleton .picmo__searchSkeleton{padding:0 8px;height:var(--search-height)}.picmo__picker.picmo__skeleton .picmo__searchSkeleton .picmo__searchInput{width:100%;height:28px;border-radius:3px}.picmo__picker.picmo__skeleton .picmo__categoryTabsSkeleton{height:var(--category-tabs-height);display:flex;flex-direction:row;align-items:center;justify-self:center;width:calc(2rem * var(--category-count, 1))}.picmo__picker.picmo__skeleton .picmo__categoryTabsSkeleton .picmo__categoryTab{width:25px;height:25px;padding:2px;border-radius:5px;margin:.25em}.picmo__picker.picmo__skeleton .picmo__contentSkeleton{height:var(--content-height);padding-right:8px;opacity:.7}.picmo__picker.picmo__skeleton .picmo__contentSkeleton .picmo__categoryName{width:50%;height:1rem;margin:.5rem;box-sizing:border-box}.picmo__picker.picmo__skeleton .picmo__contentSkeleton .picmo__emojiGrid{display:grid;justify-content:space-between;gap:1px;padding:0 .5em;grid-template-columns:repeat(var(--emojis-per-row),calc(var(--emoji-size) * var(--emoji-size-multiplier)));grid-auto-rows:calc(var(--emoji-size) * var(--emoji-size-multiplier));align-items:center;justify-items:center;width:var(--picker-width)}.picmo__picker.picmo__skeleton .picmo__contentSkeleton .picmo__emojiGrid .picmo__emoji{width:var(--emoji-size);height:var(--emoji-size);border-radius:50%}.picmo__picker.picmo__skeleton .picmo__previewSkeleton{height:var(--emoji-preview-height);border-top:1px solid var(--border-color);display:grid;align-items:center;padding:.5em;gap:6px;grid-template-columns:auto 1fr;grid-template-rows:auto 1fr;grid-template-areas:"emoji name" "emoji tags"}.picmo__picker.picmo__skeleton .picmo__previewSkeleton .picmo__previewEmoji{grid-area:emoji;border-radius:50%;width:var(--emoji-preview-size);height:var(--emoji-preview-size)}.picmo__picker.picmo__skeleton .picmo__previewSkeleton .picmo__previewName{grid-area:name;height:.8em;width:80%}.picmo__picker.picmo__skeleton .picmo__previewSkeleton .picmo__tagList{grid-area:tags;list-style-type:none;display:flex;flex-direction:row;padding:0;margin:0}.picmo__picker.picmo__skeleton .picmo__previewSkeleton .picmo__tagList .picmo__tag{border-radius:3px;padding:2px 8px;margin-right:.25em;height:1em;width:20%}.picmo__overlay{background:rgba(0,0,0,.75);height:100%;left:0;position:fixed;top:0;width:100%;z-index:1000}.picmo__content{position:relative;overflow:hidden;height:var(--content-height)}.picmo__content.picmo__fullHeight{height:calc(var(--content-height) + var(--category-tabs-height) + var(--category-tabs-offset));overflow-y:auto}.picmo__pluginContainer{margin:.5em;display:flex;flex-direction:row}.picmo__header{background-color:var(--secondary-background-color);padding-top:8px;padding-bottom:8px;display:grid;gap:8px;border-bottom:1px solid var(--border-color)}@media (prefers-reduced-motion: reduce){.picmo__placeholder{background:var(--placeholder-background-color);position:relative;overflow:hidden}.picmo__placeholder:after{display:none}}.picmo__picker .picmo__preview{border-top:1px solid var(--border-color);display:grid;align-items:center;gap:6px;grid-template-columns:auto 1fr;grid-template-rows:auto 1fr;grid-template-areas:"emoji name" "emoji tags";height:var(--emoji-preview-height);box-sizing:border-box;padding:.5em;position:relative;background:var(--preview-background-color)}.picmo__picker .picmo__preview .picmo__previewEmoji{grid-area:emoji;font-size:var(--emoji-preview-size);font-family:var(--emoji-font);width:1.25em;display:flex;align-items:center;justify-content:center}.picmo__picker .picmo__preview .picmo__previewName{grid-area:name;color:var(--text-color);font-size:.8em;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-weight:500}.picmo__picker .picmo__preview .picmo__tagList{grid-area:tags;list-style-type:none;display:flex;flex-direction:row;padding:0;margin:0;font-size:.75em;overflow:hidden}.picmo__picker .picmo__preview .picmo__tag{border-radius:3px;background:var(--tag-background-color);color:var(--text-color);padding:2px 8px;margin-right:.25em;white-space:nowrap}.picmo__picker .picmo__preview .picmo__tag:last-child{margin-right:0}.picmo__picker .picmo__searchContainer{display:flex;height:var(--search-height);box-sizing:border-box;padding:0 8px;position:relative}.picmo__picker .picmo__searchContainer .picmo__searchField{background:var(--search-background-color);border-radius:3px;border:none;box-sizing:border-box;color:var(--text-color);font-size:.9em;outline:none;padding:.5em 2.25em .5em .5em;width:100%}.picmo__picker .picmo__searchContainer .picmo__searchField:focus{background:var(--search-focus-background-color)}.picmo__picker .picmo__searchContainer .picmo__searchField::placeholder{color:var(--search-placeholder-color)}.picmo__picker .picmo__searchContainer .picmo__searchAccessory{color:var(--search-icon-color);height:100%;position:absolute;right:1em;top:0;width:1.25rem;display:flex;align-items:center}.picmo__picker .picmo__searchContainer .picmo__searchAccessory svg{fill:var(--search-icon-color)}.picmo__picker .picmo__searchContainer .picmo__clearButton{border:0;color:var(--search-icon-color);background:transparent;cursor:pointer}.picmo__picker .picmo__searchContainer .picmo__clearSearchButton{cursor:pointer;border:none;background:transparent;color:var(--search-icon-color);font-size:1em;width:100%;height:100%;display:flex;align-items:center;padding:0}.picmo__picker .picmo__searchContainer .picmo__notFound [data-icon]{fill:#f3e265}.picmo__picker .picmo__variantOverlay{background:var(--overlay-background-color);border-radius:5px;display:flex;flex-direction:column;height:100%;justify-content:center;left:0;position:absolute;top:0;width:100%;z-index:1}.picmo__picker .picmo__variantOverlay .picmo__variantPopup{background:var(--variant-popup-background-color);border-radius:5px;margin:.5em;padding:.5em;text-align:center;user-select:none;display:flex;align-items:center;justify-content:center}.picmo__customEmoji{width:1em;height:1em}@keyframes shine{to{transform:translate(100%)}}.picmo__picker .picmo__imagePlaceholder{width:2rem;height:2rem;border-radius:50%}.picmo__placeholder{background:#DDDBDD;position:relative}.picmo__placeholder:after{position:absolute;top:0;right:0;bottom:0;left:0;transform:translate(-100%);background-image:linear-gradient(90deg,rgba(255,255,255,0) 0,rgba(255,255,255,.2) 20%,rgba(255,255,255,.5) 60%,rgba(255,255,255,0) 100%);animation:shine 2s infinite;content:""}\n');const t=function(e={}){return{...eo,...e,renderer:e.renderer||new Ut,recentsProvider:e.recentsProvider||new Zt}}(e),o=((null==t?void 0:t.custom)||[]).map((e=>({...e,custom:!0,tags:["custom",...e.tags||[]]}))),i=new co;mi||(mi=function(e){return wt(e.locale,e.dataStore,e.messages,e.emojiData)}(t));const s=new ui(t.i18n);mi.then((e=>{i.emit("data:ready",e)})).catch((e=>{i.emit("error",e)}));const n=new di({events:i,i18n:s,customEmojis:o,renderer:t.renderer,options:t,emojiData:mi,pickerId:`picmo-${Date.now()}-${pi++}`}).create(li);return n.renderSync(),n}Symbol.toStringTag;class vi{createTooltip(){return this.createElement("div",["reaction-tooltip"])}createElement(e,t=[]){const o=document.createElement(e);return o.classList.add(...t),o}attachTooltipModalEvents(e,t){e.addEventListener("mouseover",(()=>{let o=document.querySelector(".reaction-modal");o||(o=this.createElement("div",["reaction-modal"]),document.body.appendChild(o));const i=e.getBoundingClientRect();o.style.position="fixed",o.style.top=i.top-o.offsetHeight+"px",o.style.left=`${i.left+e.offsetWidth/2}px`;const s=e.dataset.names?JSON.parse(e.dataset.names):t;o.textContent=s.join(", ")})),e.addEventListener("mouseout",(()=>{const e=document.querySelector(".reaction-modal");null==e||e.remove()})),e.dataset.names=JSON.stringify(t)}addUserToTooltipModal(e,t){const o=document.querySelector(".reaction-modal");if(!o)return;const i=e.dataset.names?JSON.parse(e.dataset.names):[];i.push(t),e.dataset.names=JSON.stringify(i),o.textContent=i.join(", ")}removeUserFromTooltipModal(e,t){const o=document.querySelector(".reaction-modal");if(!o)return;const i=e.dataset.names?JSON.parse(e.dataset.names):[],s=i.indexOf(t);-1!==s&&(i.splice(s,1),0!==i.length?(e.dataset.names=JSON.stringify(i),o.textContent=i.join(", ")):o.remove())}}var yi=function(e,t,o,i){return new(o||(o=Promise))((function(s,n){function r(e){try{c(i.next(e))}catch(e){n(e)}}function a(e){try{c(i.throw(e))}catch(e){n(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,a)}c((i=i.apply(e,t||[])).next())}))};class wi{constructor(){this.settings=t,this.emojiPicker=null,this.tooltip=new vi,this.initialize(),this.attachEventListeners()}initialize(){return yi(this,void 0,void 0,(function*(){yield this.init()}))}init(){return yi(this,void 0,void 0,(function*(){yield this.loadSettings()}))}loadSettings(){return yi(this,void 0,void 0,(function*(){this.settings=yield o()}))}attachEventListeners(){document.addEventListener("keydown",this.handleKeyPress.bind(this)),document.addEventListener("click",this.handleClick.bind(this))}groupAndCountReactionsByBugnoteId(e){return e.reduce(((e,t)=>{const o="c"+t.bugnote_id,i=t.emoji||"unknown",s=t.username||"unknown";return e[o]=e[o]||{},e[o][i]=e[o][i]||{count:0,reactions:[],usernames:[]},e[o][i].count++,e[o][i].reactions.push(t),e[o][i].usernames.includes(s)||e[o][i].usernames.push(s),e}),{})}getAllReactions(){return yi(this,void 0,void 0,(function*(){try{const e=yield fetch(this.settings.url,{method:"POST",headers:{"Content-Type":"application-json"},body:JSON.stringify({bugId:this.settings.bugId,action:this.settings.actions.get_reactions})});if(!e.ok){const t=`Failed ${this.settings.actions.get_reactions} action. Status: ${e.status}. Message: ${yield e.text()}`;throw console.error(t),new Error(t)}return yield e.json()}catch(e){throw console.error(`Error performing ${this.settings.actions.get_reactions} action.`,e),e}}))}createReactionContainer(e){return yi(this,void 0,void 0,(function*(){const t=yield this.getAllReactions(),o=this.groupAndCountReactionsByBugnoteId(t),i=document.createElement("div");if(i.classList.add("bugnote-reaction-icons","bugnote-reaction-icons-"+e),!o[e])return i;for(const[t,{count:s,usernames:n}]of Object.entries(o[e])){const o=this.createReactionButton(t,n),r=this.createElement("span",["reaction-count"]);r.textContent=s.toString(),o.textContent=`${t}`,o.dataset.bugnoteId=e,o.appendChild(r),i.appendChild(o)}return i}))}createButton(e){const t=this.createElement("button",["reaction-button"]);return t.dataset.emoji=e,t.textContent=e,t}createElement(e,t=[]){const o=document.createElement(e);return o.classList.add(...t),o}createReactionButton(e,t){const o=this.createButton(e),i=this.tooltip.createTooltip();return o.textContent=e,o.appendChild(i),o.addEventListener("click",(()=>{this.handleEmojiClick(e,o)})),this.tooltip.attachTooltipModalEvents(o,t),o}applyStyles(e,t){Object.assign(e.style,t)}createEmojiPicker(e){const t=()=>{this.closeEmojiPicker(),this.emojiPicker=null};e.addEventListener("click",(()=>{if(this.emojiPicker)return void t();const o=(()=>{let e=document.querySelector("#pickerContainer");return e||(e=document.createElement("div"),e.id="pickerContainer",document.body.appendChild(e)),e})(),{top:i,left:s}=(e=>{const t=e.getBoundingClientRect();return{top:t.top+window.scrollY+t.height,left:t.left+window.scrollX}})(e);((e,t)=>{const o=fi({rootElement:e});o.addEventListener("emoji:select",t)})(o,(t=>{this.handleEmojiClick(t.emoji,e),document.body.removeChild(o),this.emojiPicker=null})),this.applyStyles(o,{position:"absolute",zIndex:"999999",top:`${i}px`,left:`${s}px`,display:"block"}),this.emojiPicker=o}))}handleEmojiClick(e,t){return yi(this,void 0,void 0,(function*(){const o=this.getBugnoteId(t),i=yield this.saveReaction(e,o),s=document.querySelector(`.bugnote-reaction-icons-${o}`);if(!s)return;const n=s.querySelector(`[data-emoji="${e}"]`);if(n)(null==i?void 0:i.action)&&this.updateReactionCount(n,i);else{const t=this.createReactionButton(e,[i.username]),o=this.createElement("span",["reaction-count"]);o.textContent="1",t.appendChild(o),s.appendChild(t)}}))}updateReactionCount(e,t){const o=e.querySelector(".reaction-count");if(o){const i=parseInt(o.textContent||"0"),s=this.calculateNewCount(i,t.action);"delete"===t.action?this.tooltip.removeUserFromTooltipModal(e,t.username):"save"===t.action&&this.tooltip.addUserToTooltipModal(e,t.username),this.updateButtonOrRemove(e,s,o)}}calculateNewCount(e,t){return"delete"===t?e-1:e+1}updateButtonOrRemove(e,t,o){0===t?e.remove():o.textContent=t.toString()}getBugnoteId(e){const t=e.closest("tr");if(!t)throw new Error("Closest <tr> not found");const o=t.getAttribute("id");if(!o)throw new Error("Bugnote ID not found");return o}saveReaction(e,t){return yi(this,void 0,void 0,(function*(){try{const o=yield this.sendReactionRequest(e,t);if(!o.ok){const e=`Failed ${this.settings.actions.reaction} action. Status: ${o.status}. Message: ${yield o.text()}`;throw console.error(e),new Error(e)}const i=yield o.text();try{const e=JSON.parse(i);return{action:"delete"===e.action||"save"===e.action?e.action:"save",username:e.username}}catch(e){throw console.error("Failed to parse server response as JSON:",e),new Error(`Invalid JSON response: ${i}`)}}catch(e){throw console.error(`Error performing ${this.settings.actions.reaction} action.`,e),e}}))}sendReactionRequest(e,t){return yi(this,void 0,void 0,(function*(){return fetch(this.settings.url,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bugnoteId:t,bugId:this.settings.bugId,emoji:e,action:this.settings.actions.reaction})})}))}handleKeyPress(e){if(this.emojiPicker)return"Escape"===e.key?this.closeEmojiPicker():void 0}handleClick(e){const t=e.target,o=document.querySelectorAll(".bugnote-reaction-icon"),i=Array.from(o).some((e=>e===t));!this.emojiPicker||this.emojiPicker.contains(t)||i||this.closeEmojiPicker()}closeEmojiPicker(){this.emojiPicker&&(this.emojiPicker.remove(),this.emojiPicker=null)}}var bi=function(e,t,o,i){return new(o||(o=Promise))((function(s,n){function r(e){try{c(i.next(e))}catch(e){n(e)}}function a(e){try{c(i.throw(e))}catch(e){n(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,a)}c((i=i.apply(e,t||[])).next())}))};class ki{constructor(){this.settings=t,this.iconManager=new Ae,this.bugnoteHelper=new Re,this.reactionIconManager=new wi,this.highlightedBugnotes=[],this.highlightedClass="highlighted"}init(){return bi(this,void 0,void 0,(function*(){yield this.moveSavedBugnotesButton(),yield this.loadSettings(),yield this.loadHighlightedBugnotes(),yield this.initializeBugnoteUI()}))}loadSettings(){return bi(this,void 0,void 0,(function*(){this.settings=yield o()}))}loadHighlightedBugnotes(){return bi(this,void 0,void 0,(function*(){this.highlightedBugnotes=yield this.bugnoteHelper.getHighlightedBugnotes()}))}initializeBugnoteUI(){return bi(this,void 0,void 0,(function*(){const e=this.bugnoteHelper.getBugnotesTableRows();e&&0!==e.length&&requestIdleCallback((()=>bi(this,void 0,void 0,(function*(){for(const t of e)yield this.processBugnote(t)}))))}))}processBugnote(e){return bi(this,void 0,void 0,(function*(){const t=e.parentElement.id,o=this.createDivWrapper(),i=this.createBugnoteIconsDiv(),s=this.iconManager.createSaveBugnoteIcon(),n=this.iconManager.createReactionOnBugnoteIcon();this.highlightedBugnotes.includes(t)&&(this.makeBugnoteHighlighted(e),s.classList.add(this.iconManager.saveIconClass),s.classList.remove(this.iconManager.savedIconClass)),i.append(s,n),o.appendChild(i),e.appendChild(o),s.addEventListener("click",(()=>this.handleSaveIconClick(e)));const r=yield this.reactionIconManager.createReactionContainer(t);e.appendChild(r),this.reactionIconManager.createEmojiPicker(n)}))}createElement(e,t){const o=document.createElement(e);return o.classList.add(t),o}createDivWrapper(){return this.createElement("div","bugnote-wrapper")}createBugnoteIconsDiv(){return this.createElement("div","bugnote-icons")}handleSaveIconClick(e){return bi(this,void 0,void 0,(function*(){const t=e.parentElement.id,o=this.getAction(e);this.toggleBugnoteHighlight(e,t);try{const e=yield fetch(this.settings.url,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bugnoteId:t,bugId:this.settings.bugId,action:o})});e.ok||console.error(`Failed ${o} action. Status: ${e.status}. Message: ${yield e.text()}`)}catch(e){console.error(`Error performing ${o} action.`,e)}}))}getAction(e){return e.parentElement.classList.contains(this.highlightedClass)?this.settings.actions.unhighlight:this.settings.actions.highlight}toggleBugnoteHighlight(e,t){e.parentElement.classList.contains(this.highlightedClass)?this.highlightedBugnotes=this.highlightedBugnotes.filter((e=>e!==t)):this.highlightedBugnotes.push(t),this.makeBugnoteHighlighted(e)}makeBugnoteHighlighted(e){this.bugnoteHelper.makeBugnoteHighlighted(e),this.iconManager.toggleSaveBugnoteIcon(e)}moveSavedBugnotesButton(){return bi(this,void 0,void 0,(function*(){const e=document.querySelector("a[href='#history']"),t=document.querySelector("#savedBugnotesLinkButton");if(e&&t){const o=e.parentElement;o&&o.append(e,t)}}))}}(new ki).init()})();